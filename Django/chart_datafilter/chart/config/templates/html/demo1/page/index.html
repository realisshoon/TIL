
<!DOCTYPE html>
<!--
Author: Keenthemes
Product Name: Metronic - Bootstrap 5 HTML, VueJS, React, Angular & Laravel Admin Dashboard Theme
Purchase: https://1.envato.market/EA4JP
Website: http://www.keenthemes.com
Contact: support@keenthemes.com
Follow: www.twitter.com/keenthemes
Dribbble: www.dribbble.com/keenthemes
Like: www.facebook.com/keenthemes
License: For each use you must have a valid license purchased only from above link in order to legally use the theme for your project.
-->
{% load humanize %}
<html lang="en">
	<!--begin::Head-->
	<head><base href="">
		<title>&nbsp;ㅤ</title>
		<meta charset="utf-8" />
		<meta name="description" content="The most advanced Bootstrap Admin Theme on Themeforest trusted by 94,000 beginners and professionals. Multi-demo, Dark Mode, RTL support and complete React, Angular, Vue &amp; Laravel versions. Grab your copy now and get life-time updates for free." />
		<meta name="keywords" content="Metronic, bootstrap, bootstrap 5, Angular, VueJs, React, Laravel, admin themes, web design, figma, web development, free templates, free admin themes, bootstrap theme, bootstrap template, bootstrap dashboard, bootstrap dak mode, bootstrap button, bootstrap datepicker, bootstrap timepicker, fullcalendar, datatables, flaticon" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta property="og:locale" content="en_US" />
		<meta property="og:type" content="article" />
		<meta property="og:title" content="Metronic - Bootstrap 5 HTML, VueJS, React, Angular &amp; Laravel Admin Dashboard Theme" />
		<meta property="og:url" content="https://keenthemes.com/metronic" />
		<meta property="og:site_name" content="Keenthemes | Metronic" />
		<link rel="canonical" href="https://preview.keenthemes.com/metronic8" />
		<!--begin::Fonts-->
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" />
		<!--end::Fonts-->
		<!--begin::Page Vendor Stylesheets(used by this page)-->
		<link href="/static/assets/plugins/custom/fullcalendar/fullcalendar.bundle.css" rel="stylesheet" type="text/css" />
		<link href="/static/assets/plugins/custom/datatables/datatables.bundle.css" rel="stylesheet" type="text/css" />
		<!--end::Page Vendor Stylesheets-->
		<!--begin::Global Stylesheets Bundle(used by all pages)-->
		<link href="/static/assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />
		<link href="/static/assets/css/style.bundle.css" rel="stylesheet" type="text/css" />
		<!--end::Global Stylesheets Bundle-->
	</head>
	<style>
		  #my_table tr:nth-child(8n) { border-bottom: 1px solid #A1A5B7 !important;  }
		  #dept_my_table tr:nth-child(6) { border-bottom: 1px solid #A1A5B7 !important;  }
          td {
              text-align: right !important; ;
          }
        .div_info {
          position: relative;
        }

          .badge {
              position: absolute;
              top: 0;
              right: 0;
              width: 20px;
              height: 20px;
              background-color: #ff6b6b;
              border-radius: 50%;
              display: flex;
              justify-content: center;
              align-items: center;
              font-size: 12px;
              color: #fff;
          }

        /* styles.css */
        .info-box {
            display: none;
            position: absolute;
            background-color: #fff;
            border: 1px solid #ccc;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

	</style>
	<!--end::Head-->
	<!--begin::Body-->
	<body id="kt_body" class="header-fixed header-tablet-and-mobile-fixed toolbar-enabled toolbar-fixed aside-enabled aside-fixed" style="--kt-toolbar-height:55px;--kt-toolbar-height-tablet-and-mobile:55px">
		<div class="d-flex flex-column flex-root">
			<!--begin::Page-->
			<div class="page d-flex flex-row flex-column-fluid">
				<div class="d-flex flex-column flex-row-fluid" id="kt_wrapper">
					<div class="content d-flex flex-column flex-column-fluid" id="kt_content">
						<!--end::Toolbar-->
						<div class="post d-flex flex-column-fluid" id="kt_post">
							<div id="kt_content_container" class="container-xxl">
								<!--begin::Row-->
								<span class="nav-link btn-color-muted btn-active btn-active-light-primary active fw-bolder" id="chart_display" style="display: none; cursor:pointer" >차트 접기</span>
							<div class="chart_test" style="display: none">
								<div class="row gy-5 g-xl-8">
									<!--begin::Col-->
									<div class="col-xl-4">
										<!--begin::Mixed Widget 7-->
										<div class="card card-xl-stretch-50 mb-5 mb-xl-8">
											<!--begin::Body-->
											<div class="card-body p-0 d-flex justify-content-between flex-column overflow-hidden">
												<!--begin::Hidden-->
												<div class="d-flex flex-stack flex-wrap flex-grow-1 px-9 pt-9 pb-3">
													<div class="me-2">
														<span class="fw-bolder text-gray-800 d-block fs-3">VENUS</span>
														<span class="text-gray-400 fw-bold">월별 생산량</span>
													</div>
												</div>
												<!--end::Hidden-->
												<!--begin::Chart-->
												<div class="mixed-widget-10-chart" data-kt-color="primary" style="height: 175px"></div>
												<!--end::Chart-->
											</div>
										</div>
										<!--end::Mixed Widget 7-->
										<!--begin::Mixed Widget 10-->
										<div class="card card-xl-stretch-50 mb-5 mb-xl-8">
											<!--begin::Body-->
											<div class="card-body p-0 d-flex justify-content-between flex-column overflow-hidden">
												<!--begin::Hidden-->
												<div class="d-flex flex-stack flex-wrap flex-grow-1 px-9 pt-9 pb-3">
													<div class="me-2">
														<span class="fw-bolder text-gray-800 d-block fs-3">WACOAL</span>
														<span class="text-gray-400 fw-bold">월별 생산량</span>
													</div>
												</div>
												<!--end::Hidden-->
												<!--begin::Chart-->
												<div class="mixed-widget-13-chart" data-kt-color="primary" style="height: 175px"></div>
												<!--end::Chart-->
											</div>
										</div>
										<!--end::Mixed Widget 10-->
									</div>
									<!--end::Col-->
									<!--begin::Col-->
									<div class="col-xl-4">
										<!--begin::Mixed Widget 7-->
										<div class="card card-xl-stretch-50 mb-5 mb-xl-8">
											<!--begin::Body-->
											<div class="card-body p-0 d-flex justify-content-between flex-column overflow-hidden">
												<!--begin::Hidden-->
												<div class="d-flex flex-stack flex-wrap flex-grow-1 px-9 pt-9 pb-3">
													<div class="me-2">
														<span class="fw-bolder text-gray-800 d-block fs-3">VENUS</span>
														<span class="text-gray-400 fw-bold">실판매</span>
													</div>
												</div>
												<!--end::Hidden-->
												<!--begin::Chart-->
												<div class="mixed-widget-11-chart" data-kt-color="primary" style="height: 175px"></div>
												<!--end::Chart-->
											</div>
										</div>
										<!--end::Mixed Widget 7-->
										<!--begin::Mixed Widget 10-->
										<div class="card card-xl-stretch-50 mb-5 mb-xl-8">
											<!--begin::Body-->
											<div class="card-body p-0 d-flex justify-content-between flex-column overflow-hidden">
												<!--begin::Hidden-->
												<div class="d-flex flex-stack flex-wrap flex-grow-1 px-9 pt-9 pb-3">
													<div class="me-2">
														<span class="fw-bolder text-gray-800 d-block fs-3">WACOAL</span>
														<span class="text-gray-400 fw-bold">실판매</span>
													</div>
												</div>
												<!--end::Hidden-->
												<!--begin::Chart-->
												<div class="mixed-widget-14-chart" data-kt-color="primary" style="height: 175px"></div>
												<!--end::Chart-->
											</div>
										</div>
										<!--end::Mixed Widget 10-->
									</div>
									<!--end::Col-->
									<!--begin::Col-->
									<div class="col-xl-4">
										<!--begin::Mixed Widget 7-->
										<div class="card card-xl-stretch-50 mb-5 mb-xl-8">
											<!--begin::Body-->
											<div class="card-body p-0 d-flex justify-content-between flex-column overflow-hidden">
												<!--begin::Hidden-->
												<div class="d-flex flex-stack flex-wrap flex-grow-1 px-9 pt-9 pb-3">
													<div class="me-2">
														<span class="fw-bolder text-gray-800 d-block fs-3">VENUS</span>
														<span class="text-gray-400 fw-bold">재고수량</span>
													</div>
												</div>
												<!--end::Hidden-->
												<!--begin::Chart-->
												<div class="mixed-widget-12-chart" data-kt-color="primary" style="height: 175px"></div>
												<!--end::Chart-->
											</div>
										</div>
										<!--end::Mixed Widget 7-->
										<!--begin::Mixed Widget 10-->
										<div class="card card-xl-stretch-50 mb-5 mb-xl-8">
											<!--begin::Body-->
											<div class="card-body p-0 d-flex justify-content-between flex-column overflow-hidden">
												<!--begin::Hidden-->
												<div class="d-flex flex-stack flex-wrap flex-grow-1 px-9 pt-9 pb-3">
													<div class="me-2">
														<span class="fw-bolder text-gray-800 d-block fs-3">WACOAL</span>
														<span class="text-gray-400 fw-bold">재고수량</span>
													</div>
												</div>
												<!--end::Hidden-->
												<!--begin::Chart-->
												<div class="mixed-widget-15-chart" data-kt-color="primary" style="height: 175px"></div>
												<!--end::Chart-->
											</div>
										</div>
										<!--end::Mixed Widget 10-->
									</div>
									<!--end::Col-->
								</div>
								<!--end::Row-->
								<!--begin::Row-->
								<div class="row gy-5 g-xl-8">
									<!--begin::Col-->
									<div class="col-xl-4">
										<!--begin::Mixed Widget 7-->
										<div class="card card-xl-stretch-100 mb-5 mb-xl-8">
											<!--begin::Body-->
											<div class="card-body p-0 d-flex justify-content-between flex-column overflow-hidden">
												<!--begin::Hidden-->
												<div class="d-flex flex-stack flex-wrap flex-grow-1 px-9 pt-9 pb-3">
													<div class="me-2">
														<span class="fw-bolder text-gray-800 d-block fs-3">SOLB</span>
														<span class="text-gray-400 fw-bold">월별 생산량</span>
													</div>
												</div>
												<!--end::Hidden-->
												<!--begin::Chart-->
												<div class="mixed-widget-16-chart" data-kt-color="primary" style="height: 175px"></div>
												<!--end::Chart-->
											</div>
										</div>
									</div>

									<div class="col-xl-4">
										<!--begin::Mixed Widget 7-->
										<div class="card card-xl-stretch-100 mb-5 mb-xl-8">
											<!--begin::Body-->
											<div class="card-body p-0 d-flex justify-content-between flex-column overflow-hidden">
												<!--begin::Hidden-->
												<div class="d-flex flex-stack flex-wrap flex-grow-1 px-9 pt-9 pb-3">
													<div class="me-2">
														<span class="fw-bolder text-gray-800 d-block fs-3">SOLB</span>
														<span class="text-gray-400 fw-bold">실판매</span>
													</div>
												</div>
												<!--end::Hidden-->
												<!--begin::Chart-->
												<div class="mixed-widget-17-chart" data-kt-color="primary" style="height: 175px"></div>
												<!--end::Chart-->
											</div>
										</div>
									</div>
									<div class="col-xl-4">
										<!--begin::Mixed Widget 7-->
										<div class="card card-xl-stretch-100 mb-5 mb-xl-8">
											<!--begin::Body-->
											<div class="card-body p-0 d-flex justify-content-between flex-column overflow-hidden">
												<!--begin::Hidden-->
												<div class="d-flex flex-stack flex-wrap flex-grow-1 px-9 pt-9 pb-3">
													<div class="me-2">
														<span class="fw-bolder text-gray-800 d-block fs-3">SOLB</span>
														<span class="text-gray-400 fw-bold">재고수량</span>
													</div>
												</div>
												<!--end::Hidden-->
												<!--begin::Chart-->
												<div class="mixed-widget-18-chart" data-kt-color="primary" style="height: 175px"></div>
												<!--end::Chart-->
											</div>
										</div>
									</div>
								</div>
							</div>
									<div class="card mb-5 mb-xl-8">
									<!--begin::Header-->
									<div class="card-header border-0 pt-5">
										<h3 class="card-title align-items-start flex-column">
											<span class="card-label fw-bolder fs-3 mb-1">생산 판매 재고 계획</span>
											<span class="text-muted mt-1 fw-bold fs-7">{{year}}년</span>
										</h3>
										<div class="card-toolbar">
											<!--begin::Menu-->
											<button type="button" class="btn btn-sm btn-icon btn-color-primary btn-active-light-primary" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">
												<!--begin::Svg Icon | path: icons/duotune/general/gen024.svg-->
												<span class="svg-icon svg-icon-2">
													<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
														<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
															<rect x="5" y="5" width="5" height="5" rx="1" fill="currentColor"></rect>
															<rect x="14" y="5" width="5" height="5" rx="1" fill="currentColor" opacity="0.3"></rect>
															<rect x="5" y="14" width="5" height="5" rx="1" fill="currentColor" opacity="0.3"></rect>
															<rect x="14" y="14" width="5" height="5" rx="1" fill="currentColor" opacity="0.3"></rect>
														</g>
													</svg>
												</span>
												<!--end::Svg Icon-->
											</button>
											<!--begin::Menu 2-->
											<div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fw-bold w-200px" data-kt-menu="true">
												<!--begin::Menu item-->
												<div class="menu-item px-3">
													<div class="menu-content fs-6 text-dark fw-bolder px-3 py-4">Dashboard</div>
												</div>
												<!--end::Menu item-->
												<!--begin::Menu separator-->
												<div class="separator mb-3 opacity-75"></div>
												<!--end::Menu separator-->
												<!--begin::Menu item-->
												<div class="menu-item px-3">
													<a href="#" class="menu-link px-3" onclick="test()">차트로 내용 보기</a>
												</div>
												<div class="separator mb-3 opacity-75"></div>
												<div class="menu-item px-3">
													<a href="#" class="menu-link px-3" onclick="exportTableToExcel()">Excel Export</a>
												</div>
												<div class="separator mb-3 opacity-75"></div>
											</div>
											<!--end::Menu 2-->
											<!--end::Menu-->
										</div>
									</div>
									<!--end::Header-->
									<!--begin::Body-->
									<div class="card-body py-3" class="table_view_static">
										<!--begin::Table container-->
										<div class="table-responsive">
											<!--begin::Table-->
											<table class="table align-middle gs-0 gy-4" id="my_table">
												<!--begin::Table head-->
												<thead>
													<tr class="fw-bolder text-muted bg-light">
														<th class="ps-3 min-w-150px rounded-start title-font-color" colspan="3" style="text-align: center">구분</th>
                                                        {% for data in month %}
                                                            <th class="min-w-75px title-font-color"  style="text-align: center !important;">{{data}}월</th>
                                                        {% endfor %}
													</tr>
												</thead>
												<!--end::Table head-->
												<!--begin::Table body-->
												<tbody>
													<tr onclick="dash_click('VENUS')">
														<td rowspan="8" class="br-1">
															<div class="d-flex align-items-center">
																<div class="d-flex justify-content-start flex-column" style="margin: 0 auto;">
																	<a href="#" class="text-dark fw-bolder text-hover-primary mb-1 fs-6">VENUS</a>
																</div>
															</div>
														</td>
														<td rowspan="2" class="br-2">생산</td>
                                                        <td class="br-0">생산량</td>
                                                        {% for item in venus_p1 %}
                                                          {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1">{{ item|default:"0"|intcomma }}</td>
                                                                {% else %}
                                                                    <td>{{ item|default:"0"|intcomma }}</td>
                                                                {% endif %}
                                                          {% endif %}
                                                        {% endfor %}
													  </tr>
													  <tr onclick="dash_click('VENUS')">
														<td class="br-0">전년%</td>
                                                      {% for item in venus_p2 %}
                                                          {% if forloop.counter > 2 %}
                                                            {% if forloop.counter == 6 %}
                                                                <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                            {% else %}
                                                                <td class="bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                            {% endif %}
                                                          {% endif %}
                                                      {% endfor %}
													  </tr>
													  <tr onclick="dash_click('VENUS')">
														<td rowspan="4" class="br-2">실판매</td>
														<td class="br-0">실판매</td>
                                                          {% for item in venus_a1 %}
                                                              {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1">{{ item|default:"0"|intcomma }}</td>
                                                                {% else %}
                                                                    <td>{{ item|default:"0"|intcomma }}</td>
                                                                {% endif %}
                                                              {% endif %}
                                                          {% endfor %}
													  </tr>
													  <tr onclick="dash_click('VENUS')">
														<td class="br-0">전년%</td>
                                                          {% for item in venus_a2 %}
                                                              {% if forloop.counter > 2 %}
                                                                 {% if forloop.counter == 6 %}
                                                                    <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                 {% else %}
                                                                    <td class="bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% endif %}
                                                              {% endif %}
                                                          {% endfor %}
													  </tr>
													  <tr onclick="dash_click('VENUS')">
														<td class="br-0">실판매(EC)</td>
                                                          {% for item in venus_e1 %}
                                                              {% if forloop.counter > 2 %}
                                                                 {% if forloop.counter == 6 %}
                                                                    <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}</td>
                                                                 {% else %}
                                                                    <td class="">{{ item|default:"0"|intcomma }}</td>
                                                                {% endif %}
                                                              {% endif %}
                                                          {% endfor %}
													  </tr>
													  <tr onclick="dash_click('VENUS')">
														<td class="br-0">비율(EC)%</td>
                                                          {% for item in venus_e2 %}
                                                              {% if forloop.counter > 2 %}
                                                                 {% if forloop.counter == 6 %}
                                                                    <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                 {% else %}
                                                                    <td class="bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% endif %}
                                                              {% endif %}
                                                          {% endfor %}
													  </tr>
													  <tr onclick="dash_click('VENUS')">
														<td rowspan="2" class="br-2">재고</td>
														<td class="br-0">재고수량</td>
                                                          {% for item in venus_i1 %}
                                                              {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1">{{ item|default:"0"|intcomma }}</td>
                                                                {% else %}
                                                                    <td>{{ item|default:"0"|intcomma }}</td>
                                                                {% endif %}
                                                              {% endif %}
                                                          {% endfor %}
													  </tr>
													  <tr onclick="dash_click('VENUS')">
														<td class="br-0">전년%</td>
                                                          {% for item in venus_i2 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% else %}
                                                                <td class="bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% endif %}
                                                            {% endif %}
                                                          {% endfor %}
													  </tr>

													<tr onclick="dash_click('WACOAL')">
														<td rowspan="8" class="br-1">
															<div class="d-flex align-items-center">
																<div class="d-flex justify-content-start flex-column"  style="margin: 0 auto;">
																	<a href="#" class="text-dark fw-bolder text-hover-primary mb-1 fs-6">WACOAL</a>
																</div>
															</div>
														</td>
														<td rowspan="2" class="br-2">생산</td>
														<td class="br-0">생산량</td>
                                                        {% for item in wacoal_p1 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1">{{ item|default:"0"|intcomma }}</td>
                                                                {% else %}
                                                                    <td>{{ item|default:"0"|intcomma }}</td>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    </tr>
                                                    <tr onclick="dash_click('WACOAL')">
                                                        <td class="br-0">전년%</td>
                                                        {% for item in wacoal_p2 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% else %}
                                                                    <td class="bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    </tr>
                                                    <tr onclick="dash_click('WACOAL')">
                                                        <td rowspan="4" class="br-2">실판매</td>
                                                        <td class="br-0">실판매</td>
                                                        {% for item in wacoal_a1 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1">{{ item|default:"0"|intcomma }}</td>
                                                                {% else %}
                                                                    <td>{{ item|default:"0"|intcomma }}</td>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    </tr>
                                                    <tr onclick="dash_click('WACOAL')">
                                                        <td class="br-0">전년%</td>
                                                        {% for item in wacoal_a2 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% else %}
                                                                    <td class="bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    </tr>
                                                    <tr onclick="dash_click('WACOAL')">
                                                        <td class="br-0">실판매(EC)</td>
                                                        {% for item in wacoal_e1 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}</td>
                                                                {% else %}
                                                                    <td class="">{{ item|default:"0"|intcomma }}</td>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    </tr>
                                                    <tr onclick="dash_click('WACOAL')">
                                                        <td class="br-0">비율(EC)%</td>
                                                        {% for item in wacoal_e2 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}%
                                                                    </td>
                                                                {% else %}
                                                                    <td class="bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    </tr>
                                                    <tr onclick="dash_click('WACOAL')">
                                                        <td rowspan="2" class="br-2">재고</td>
                                                        <td class="br-0">재고수량</td>
                                                        {% for item in wacoal_i1 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1">{{ item|default:"0"|intcomma }}</td>
                                                                {% else %}
                                                                    <td>{{ item|default:"0"|intcomma }}</td>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    </tr>
                                                    <tr onclick="dash_click('WACOAL')">
                                                        <td class="br-0">전년%</td>
                                                        {% for item in wacoal_i2 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% else %}
                                                                    <td class="bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    </tr>

													<tr onclick="dash_click('SOLB')">
														<td rowspan="8" class="br-1">
															<div class="d-flex align-items-center">
																<div class="d-flex justify-content-start flex-column"  style="margin: 0 auto;">
																	<a href="#" class="text-dark fw-bolder text-hover-primary mb-1 fs-6">SOLB</a>
																</div>
															</div>
														</td>
														<td rowspan="2" class="br-2">생산</td>
														<td class="br-0">생산량</td>
                                                        {% for item in solb_p1 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1">{{ item|default:"0"|intcomma }}</td>
                                                                {% else %}
                                                                    <td>{{ item|default:"0"|intcomma }}</td>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    </tr>
                                                    <tr onclick="dash_click('SOLB')">
                                                        <td class="br-0">전년%</td>
                                                        {% for item in solb_p2 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% else %}
                                                                    <td class="bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    </tr>
                                                    <tr onclick="dash_click('SOLB')">
                                                        <td rowspan="4" class="br-2">실판매</td>
                                                        <td class="br-0">실판매</td>
                                                        {% for item in solb_a1 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1">{{ item|default:"0"|intcomma }}</td>
                                                                {% else %}
                                                                    <td>{{ item|default:"0"|intcomma }}</td>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    </tr>
                                                    <tr onclick="dash_click('SOLB')">
                                                        <td class="br-0">전년%</td>
                                                        {% for item in solb_a2 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% else %}
                                                                    <td class="bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    </tr>
                                                    <tr onclick="dash_click('SOLB')">
                                                        <td class="br-0">실판매(EC)</td>
                                                            {% for item in solb_e1 %}
                                                                {% if forloop.counter > 2 %}
                                                                    {% if forloop.counter == 6 %}
                                                                        <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}
                                                                        </td>
                                                                    {% else %}
                                                                        <td class="">{{ item|default:"0"|intcomma }}</td>
                                                                    {% endif %}
                                                                {% endif %}
                                                            {% endfor %}
                                                    </tr>
                                                    <tr onclick="dash_click('SOLB')">
                                                        <td class="br-0">비율(EC)%</td>
                                                            {% for item in solb_e2 %}
                                                                {% if forloop.counter > 2 %}
                                                                    {% if forloop.counter == 6 %}
                                                                        <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}%
                                                                        </td>
                                                                    {% else %}
                                                                        <td class="bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                    {% endif %}
                                                                {% endif %}
                                                            {% endfor %}
                                                    </tr>
                                                    <tr onclick="dash_click('SOLB')">
                                                        <td rowspan="2" class="br-2">재고</td>
                                                        <td class="br-0">재고수량</td>
                                                        {% for item in solb_i1 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1">{{ item|default:"0"|intcomma }}</td>
                                                                {% else %}
                                                                    <td>{{ item|default:"0"|intcomma }}</td>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    </tr>
                                                    <tr onclick="dash_click('SOLB')">
                                                        <td class="br-0">전년%</td>
                                                        {% for item in solb_i2 %}
                                                            {% if forloop.counter > 2 %}
                                                                {% if forloop.counter == 6 %}
                                                                    <td class="current-m1 bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% else %}
                                                                    <td class="bg-cell-01">{{ item|default:"0"|intcomma }}%</td>
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    </tr>
												</tbody>
												<!--end::Table body-->
											</table>
											<!--end::Table-->
										</div>
										<!--end::Table container-->
									</div>
									<!--begin::Body-->
								</div>
                                <!-- 시즌 카렌다 -->
								<div class="card mb-5 mb-xl-8">
									<!--begin::Header-->
									<div class="card-header border-0 pt-5">
										<h3 class="card-title align-items-start flex-column">
											<span class="card-label fw-bolder fs-3 mb-1">SEASON CALENDAR</span>
											<span class="text-muted mt-1 fw-bold fs-7"></span>
										</h3>
									</div>
									<!--end::Header-->
									<!--begin::Body-->
									<div class="card-body py-3" class="table_view_static_x">
										<!--begin::Table container-->
										<div class="table-responsive">
											<!--begin::Table-->
											<table class="table align-middle gs-0 gy-4" id="" style="">
												<!--begin::Table head-->
												<thead>
													<tr class="fw-bolder text-muted bg-light" id="season_month">
														<th class="ps-4 min-w-75px rounded-start title-font-color" rowspan="2" style="text-align: center; vertical-align: middle;">구분</th>
													</tr>
													<tr id="season_tr">

													</tr>
												</thead>
<!--?                                            </table>-->
<!--?                                            <table class="table align-middle gs-0 gy-4" id=""  style="table-layout: fixed;">-->
												<tbody>
												  <tr style="height: auto; border-bottom: 1px solid #A1A5B7 !important; position: relative;" id="season_venus_tr">
													<th class="season-title0">VENUS</th>
												  </tr>
												  <tr style="height: auto; border-bottom: 1px solid #A1A5B7 !important; position: relative;" id="season_wacoal_tr">
													<th class="season-title0">WACOAL</th>
												  </tr>
												  <tr style="height: auto; border-bottom: 1px solid #A1A5B7 !important; position: relative;" id="season_solb_tr">
													<th class="season-title0">SOLB</th>
												  </tr>
												</tbody>
												<!--end::Table body-->
											</table>
											<!--end::Table-->
										</div>
										<!--end::Table container-->
									</div>
									<!--begin::Body-->
								</div>
                                <!-- 마케팅 캠페인 -->
                                <div class="card mb-5 mb-xl-8">
                                    <!--begin::Header-->
                                    <div class="card-header border-0 pt-5">
                                        <h3 class="card-title align-items-start flex-column">
                                            <span class="card-label fw-bolder fs-3 mb-1">Marketing Campaign</span>
                                            <span class="text-muted mt-1 fw-bold fs-7"></span>
                                        </h3>
                                    </div>
                                    <!--end::Header-->
                                    <!--begin::Body-->
                                    <div class="card-body py-3 table_view_static_x">
                                        <!--begin::Table container-->
                                        <div class="table-responsive">
                                            <!--begin::Table-->
                                            <table class="table align-middle gs-0 gy-4" id=""  style="">
                                                <!--begin::Table head-->
                                                <thead>
                                                    <tr class="fw-bolder text-muted bg-light" id="marketing_month">
                                                        <th class="ps-4 min-w-75px rounded-start title-font-color" rowspan="2" style="text-align: center; vertical-align: middle;">구분</th>
                                                    </tr>
                                                    <tr id="marketing_tr">
                                                    </tr>
                                                </thead>
<!--?                                            </table>-->
<!--?                                            <table class="table align-middle gs-0 gy-4" id=""  style="table-layout: fixed;">-->
                                                <tbody>
                                                  <tr style="height: auto; border-bottom: 1px solid #A1A5B7 !important; position: relative;" id="marketing_venus_tr">
                                                    <th class="season-title0">VENUS</th>
                                                  </tr>
                                                  <tr style="height: auto; border-bottom: 1px solid #A1A5B7 !important; position: relative;" id="marketing_wacoal_tr">
                                                    <th class="season-title0">WACOAL</th>
                                                  </tr>
                                                  <tr style="height: auto; border-bottom: 1px solid #A1A5B7 !important; position: relative;" id="marketing_solb_tr">
                                                    <th class="season-title0">SOLB</th>
                                                  </tr>
                                                </tbody>
                                                <!--end::Table body-->
                                            </table>
                                            <!--end::Table-->
                                        </div>
                                        <!--end::Table container-->
                                    </div>
                                    <!--begin::Body-->
                                </div>
								</div>

					</div>
					<!--end::Modal body-->
				</div>
				<!--end::Modal content-->
			</div>
			<!--end::Modal dialog-->
		</div>


<div class="modal fade" id="kt_modal_create_app" tabindex="-1" aria-hidden="true">
			<!--begin::Modal dialog-->
			<div class="modal-dialog modal-dialog-centered mw-900px">
				<!--begin::Modal content-->
				<div class="modal-content">
					<!--begin::Modal header-->
					<div class="modal-header">
						<!--begin::Modal title-->
						<h2>상세보기</h2>
						<!--end::Modal title-->
						<!--begin::Close-->
						<div class="btn btn-sm btn-icon btn-active-color-primary delete_btn" data-bs-dismiss="modal">
							<!--begin::Svg Icon | path: icons/duotune/arrows/arr061.svg-->
							<span class="svg-icon svg-icon-1">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
									<rect opacity="0.5" x="6" y="17.3137" width="16" height="2" rx="1" transform="rotate(-45 6 17.3137)" fill="currentColor" />
									<rect x="7.41422" y="6" width="16" height="2" rx="1" transform="rotate(45 7.41422 6)" fill="currentColor" />
								</svg>
							</span>
							<!--end::Svg Icon-->
						</div>
						<!--end::Close-->
					</div>
					<!--end::Modal header-->
					<!--begin::Modal body-->
					<div class="modal-body py-lg-10 px-lg-10">
								<div class="table-responsive">
											<!--begin::Table-->
											<table class="table align-middle gs-0 gy-4">
												<!--begin::Table head-->
												<thead>
													<tr class="fw-bolder text-muted bg-light">
														<th class="ps-4 min-w-75px rounded-start title-font-color">구분</th>
														<th class="min-w-50px title-font-color">부서코드</th>
														<th class="min-w-100px title-font-color" colspan="3" style="text-align: center;">부서명</th>
													</tr>
												</thead>
												<!--end::Table head-->
												<!--begin::Table body-->
												<tbody id="dept_modal">
												</tbody>
												<!--end::Table body-->
											</table>
											<!--end::Table-->
										</div>
					</div>
					<!--end::Modal body-->
				</div>
				<!--end::Modal content-->
			</div>
			<!--end::Modal dialog-->
		</div>


<div class="modal fade" id="kt_modal_app" tabindex="-1" aria-hidden="true">
			<!--begin::Modal dialog-->
			<div class="modal-dialog modal-dialog-centered mw-900px">
				<!--begin::Modal content-->
				<div class="modal-content">
					<!--begin::Modal header-->
					<div class="modal-header">
						<!--begin::Modal title-->
						<h2 id="kt_modal_app_title"></h2>
						<!--end::Modal title-->
						<!--begin::Close-->
						<div class="btn btn-sm btn-icon btn-active-color-primary delete_season_btn" data-bs-dismiss="modal">
							<!--begin::Svg Icon | path: icons/duotune/arrows/arr061.svg-->
							<span class="svg-icon svg-icon-1">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
									<rect opacity="0.5" x="6" y="17.3137" width="16" height="2" rx="1" transform="rotate(-45 6 17.3137)" fill="currentColor" />
									<rect x="7.41422" y="6" width="16" height="2" rx="1" transform="rotate(45 7.41422 6)" fill="currentColor" />
								</svg>
							</span>
							<!--end::Svg Icon-->
						</div>
						<!--end::Close-->
					</div>
					<!--end::Modal header-->
					<!--begin::Modal body-->
					<div class="modal-body py-lg-10 px-lg-10">
								<div class="table-responsive">
											<!--begin::Table-->
											<table class="table align-middle gs-0 gy-4">
												<!--begin::Table head-->
												<thead>
													<tr class="fw-bolder text-muted bg-light">
														<th class="ps-4 min-w-75px rounded-start title-font-color">파일 순번</th>
														<th class="min-w-75px title-font-color">파일명</th>
														<th class="min-w-75px title-font-color">파일 상세보기</th>
                                                        <th class="min-w-75px title-font-color">비고</th>
													</tr>
												</thead>
												<!--end::Table head-->
												<!--begin::Table body-->
												<tbody id="season_file">
												</tbody>
												<!--end::Table body-->
											</table>
											<!--end::Table-->
										</div>
					</div>
					<!--end::Modal body-->
				</div>
				<!--end::Modal content-->
			</div>
			<!--end::Modal dialog-->
		</div>






<div class="modal fade" id="kt_modal_app_season_calendar" tabindex="-1" aria-hidden="true">
			<!--begin::Modal dialog-->
			<div class="modal-dialog modal-dialog-centered mw-900px">
				<!--begin::Modal content-->
				<div class="modal-content">
					<!--begin::Modal header-->
					<div class="modal-header">
						<!--begin::Modal title-->
						<h2>캘린더 더보기</h2>
						<!--end::Modal title-->
						<!--begin::Close-->
						<div class="btn btn-sm btn-icon btn-active-color-primary delete_season_calendar_btn" data-bs-dismiss="modal">
							<!--begin::Svg Icon | path: icons/duotune/arrows/arr061.svg-->
							<span class="svg-icon svg-icon-1">
								<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
									<rect opacity="0.5" x="6" y="17.3137" width="16" height="2" rx="1" transform="rotate(-45 6 17.3137)" fill="currentColor" />
									<rect x="7.41422" y="6" width="16" height="2" rx="1" transform="rotate(45 7.41422 6)" fill="currentColor" />
								</svg>
							</span>
							<!--end::Svg Icon-->
						</div>
						<!--end::Close-->
					</div>
					<!--end::Modal header-->
					<!--begin::Modal body-->
					<div class="modal-body py-lg-10 px-lg-10">
								<div class="table-responsive">
											<!--begin::Table-->
											<table class="table align-middle gs-0 gy-4">
												<!--begin::Table head-->
												<thead>
													<tr class="fw-bolder text-muted bg-light">
														<th class="ps-4 min-w-75px rounded-start title-font-color">No.</th>
														<th class="min-w-75px title-font-color">브랜드</th>
														<th class="min-w-75px title-font-color">일정명</th>
                                                        <th class="min-w-75px title-font-color">기간</th>
													</tr>
												</thead>
												<!--end::Table head-->
												<!--begin::Table body-->
												<tbody>
													<tr>
														<th>
															<a href="#" class="text-dark fw-bolder d-block mb-1 fs-6 cursor-s-d">No.01</a>
														</th>
														<th>
															<a href="#" class="text-dark fw-bolder d-block mb-1 fs-6 cursor-s-d">VENUS</a>
														</th>
														<th>
															<a  onclick="app_season_calendar_file()" class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6">4월 광고 일정</a>
														</th>
                                                        <th>
                                                            <a href="#" class="text-dark fw-bolder d-block mb-1 fs-6 cursor-s-d">4월 1주 ~ 4월 4주</a>
                                                        </th>
													</tr>
													<tr>
														<th>
															<a href="#" class="text-dark fw-bolder mb-1 fs-6 cursor-s-d">No.02</a>
														</th>
														<th>
															<a href="#" class="text-dark fw-bolder d-block mb-1 fs-6 cursor-s-d">VENUS</a>
														</th>
														<th>
															<a  onclick="app_season_calendar_file()" class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6">4~5월 광고</a>
														</th>
                                                        <th>
                                                            <a href="#"
                                                               class="text-dark fw-bolder d-block mb-1 fs-6 cursor-s-d">4월 3주 ~ 5월 2주</a>
                                                        </th>
													</tr>
												</tbody>
												<!--end::Table body-->
											</table>
											<!--end::Table-->
										</div>
					</div>
					<!--end::Modal body-->
				</div>
				<!--end::Modal content-->
			</div>
			<!--end::Modal dialog-->
		</div>






			</div>


		</div>
	</body>
		<!--end::Modal - Users Search-->
		<!--end::Modals-->
		<!--begin::Javascript-->
		<script>var hostUrl = "/static/assets/";</script>
		<script src="https://code.jquery.com/jquery-3.7.0.js" integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM=" crossorigin="anonymous"></script>
		<!--begin::Global Javascript Bundle(used by all pages)-->
		<script src="/static/assets/plugins/global/plugins.bundle.js"></script>
		<script src="/static/assets/js/scripts.bundle.js"></script>
		<!--end::Global Javascript Bundle-->
		<!--begin::Page Vendors Javascript(used by this page)-->
		<script src="/static/assets/plugins/custom/fullcalendar/fullcalendar.bundle.js"></script>
		<script src="/static/assets/plugins/custom/datatables/datatables.bundle.js"></script>
		<!--end::Page Vendors Javascript-->
		<!--begin::Page Custom Javascript(used by this page)-->
		<script src="/static/assets/js/widgets.bundle.js"></script>
		<script src="/static/assets/js/custom/widgets.js"></script>
		<script src="/static/assets/js/custom/apps/chat/chat.js"></script>
		<script src="/static/assets/js/custom/utilities/modals/upgrade-plan.js"></script>
		<script src="/static/assets/js/custom/utilities/modals/create-app.js"></script>
		<script src="/static/assets/js/custom/utilities/modals/users-search.js"></script>
		<script>
            $(document).ready(function(){
                  // var isDebug = "{{ is_debug|lower }}";
                  // if(isDebug == "false") {
                  //       if (window.parent === null || window.parent === window.self) {
                  //             location.replace('/venus/error/');
                  //       }
                  // }else {
                  //     console.log("test")
                  // }
                "undefined" != typeof module && (module.exports = KTWidgets), KTUtil.onDOMContentLoaded((function () {
                    var month = {{month|safe}}
                    try {
                        var venus_p1 = {{venus_p1|safe}}
                    } catch (error) {
                        var venus_p1 = []
                    }
                    try {
                        var venus_a1 = {{venus_a1|safe}}
                    } catch (error) {
                        var venus_a1 = []
                    }
                    try {
                        var venus_i1 = {{venus_i1|safe}}
                    } catch (error) {
                        var venus_i1 = []
                    }

                    try {
                        var wacoal_p1 = {{wacoal_p1|safe}}
                    } catch (error) {
                        var wacoal_p1 = []
                    }
                    try {
                        var wacoal_a1 = {{wacoal_a1|safe}}
                    } catch (error) {
                        var wacoal_a1 = []
                    }
                    try {
                        var wacoal_i1 = {{wacoal_i1|safe}}
                    } catch (error) {
                        var wacoal_i1 = []
                    }

                    try {
                        var solb_p1 = {{solb_p1|safe}}
                    } catch (error) {
                        var solb_p1 = []
                    }
                    try {
                        var solb_a1 = {{solb_a1|safe}}
                    } catch (error) {
                        var solb_a1 = []
                    }
                    try {
                        var solb_i1 = {{solb_i1|safe}}
                    } catch (error) {
                        var solb_i1 = []
                    }

                    var monthWithLabel = month.map(value => value + "월");
                    KTWidgets.init(monthWithLabel, venus_p1, venus_a1, venus_i1, wacoal_p1, wacoal_a1, wacoal_i1, solb_p1, solb_a1, solb_i1)
                }));

                data_import();


            });
            function weeklyFunc(code, month ,week) {
                let html = "";
                const currentDate = new Date();
                const currentMonth = parseInt(currentDate.getMonth()) + 1;
                let parsing_month = month < 10 ? "0"+ String(month): month
                for(let i=1; i<=week; i++) {
                    if(month == currentMonth) {
                        html += `<th class="font-s1 current-m1"  id="${code}-${parsing_month}-${i}">${i}w</th>`
                    }else {
                        html += `<th class="font-s1"  id="${code}-${parsing_month}-${i}">${i}w</th>`
                    }
                }
                return html;
            }

            // function dataTdFunc(month, week) {
            //     // month = parseInt(month) + 1
            //     let html = "";
            //     let parsing_month = month < 10 ? "0"+ String(month): month
            //     for(let i=1; i<=week; i++) {
            //         html += `<td></td>`
            //     }
            //     return html;
            // }
             function weeksInMonth(year, month_number) {
                // month_number = parseInt(month_number) + 1
                var firstOfMonth = new Date(year, month_number-1, 1);
                var lastOfMonth = new Date(year, month_number, 0);

                var used = firstOfMonth.getDay() + lastOfMonth.getDate();

                return Math.ceil( used / 7);
            }

            function data_import() {
                const currentDate = new Date();
                const currentYear = parseInt(currentDate.getFullYear());
                const currentMonth = parseInt(currentDate.getMonth()) + 1;
                var html = ""
                var data_week = new Array()
                var data_month = new Array()
                // month -3
                for (let i = 3; i > 0; i--) {
                    let month, year;
                    if (currentMonth - i < 1) {
                        month = 12 + (currentMonth - i);
                        year = currentYear - 1;
                    } else {
                        month = currentMonth - i;
                        year = currentYear;
                    }
                    data_week.push(weeksInMonth(year, month));
                    data_month.push(month);
                }

                data_week.push(weeksInMonth(currentYear, currentMonth))
                data_month.push(currentMonth)

                for (let i = 1; i <= 3; i++) {
                    let month, year;
                    if (currentMonth + i > 12) {
                        month = (currentMonth + i) - 12
                        year = currentYear + 1
                    }else {
                        month = currentMonth + i
                        year = currentYear
                    }
                    data_week.push(weeksInMonth(year, month))
                    data_month.push(month)
                }
                var weekly_html = "";
                var td_html = "";

                for(let i=0; i<data_month.length; i++) {
                    html += `<th colspan="${data_week[i]}" style="text-align: center" class="title-font-color">${data_month[i]}월</th>`
                    weekly_html += weeklyFunc("s", data_month[i], data_week[i])
                }
                $("#season_month").append(html)
                $("#season_tr").append(weekly_html)

                html = ""
                weekly_html = ""
                for (let i = 0; i < data_month.length; i++) {
                    html += `<th colspan="${data_week[i]}" style="text-align: center" class="title-font-color">${data_month[i]}월</th>`
                    weekly_html += weeklyFunc("m", data_month[i], data_week[i])
                }

                $("#marketing_tr").append(weekly_html)
                $("#marketing_month").append(html)

                var childCount = $("#season_tr").children().length;
                td_html = `<td colspan="${childCount}"></td>`

                $("#season_venus_tr").append(td_html)
                $("#season_wacoal_tr").append(td_html)
                $("#season_solb_tr").append(td_html)

                $("#marketing_venus_tr").append(td_html)
                $("#marketing_wacoal_tr").append(td_html)
                $("#marketing_solb_tr").append(td_html)

                var season_venus_list = {{season_venus_list|safe}}
                for (let i = 0; i < season_venus_list.length; i++) {
                  let innerArray = season_venus_list[i];
                // 0:타이틀, 1:회사코드, 2:내용, 3:시작일, 4:종료일, 5: 시작월, 6:주차, 7:종료월, 8:주차
                  addCustomTd("season_venus_tr", String(innerArray[5]).slice(-2) + "-" + String(innerArray[6]), String(innerArray[7]).slice(-2) + "-" + String(innerArray[8]), innerArray[0], "#ea8237", innerArray[2], innerArray[3], innerArray[4], "S", i)
                }

                var season_wacoal_list = {{season_wacoal_list|safe}}
                for (let i = 0; i < season_wacoal_list.length; i++) {
                  let innerArray = season_wacoal_list[i];
                // 0:타이틀, 1:회사코드, 2:내용, 3:시작일, 4:종료일, 5: 시작월, 6:주차, 7:종료월, 8:주차
                  addCustomTd("season_wacoal_tr", String(innerArray[5]).slice(-2) + "-" + String(innerArray[6]), String(innerArray[7]).slice(-2) + "-" + String(innerArray[8]), innerArray[0], "#8ec390", innerArray[2], innerArray[3], innerArray[4], "S", i)
                }

                var season_solb_list = {{season_solb_list|safe}}
                for (let i = 0; i < season_solb_list.length; i++) {
                  let innerArray = season_solb_list[i];
                // 0:타이틀, 1:회사코드, 2:내용, 3:시작일, 4:종료일, 5: 시작월, 6:주차, 7:종료월, 8:주차
                  addCustomTd("season_solb_tr", String(innerArray[5]).slice(-2) + "-" + String(innerArray[6]), String(innerArray[7]).slice(-2) + "-" + String(innerArray[8]), innerArray[0], "#404fff", innerArray[2], innerArray[3], innerArray[4], "S", i)
                }

                var marketing_venus_list = {{marketing_venus_list|safe}}
                for (let i = 0; i < marketing_venus_list.length; i++) {
                    let innerArray = marketing_venus_list[i];
                    addCustomTd("marketing_venus_tr", String(innerArray[5]).slice(-2) + "-" + String(innerArray[6]), String(innerArray[7]).slice(-2) + "-" + String(innerArray[8]), innerArray[0], "#ea8237", innerArray[2], innerArray[3], innerArray[4], "M", i)
                }

                var marketing_wacoal_list = {{marketing_wacoal_list|safe}}
                for (let i = 0; i < marketing_wacoal_list.length; i++) {
                    let innerArray = marketing_wacoal_list[i];
                    addCustomTd("marketing_wacoal_tr", String(innerArray[5]).slice(-2) + "-" + String(innerArray[6]), String(innerArray[7]).slice(-2) + "-" + String(innerArray[8]), innerArray[0], "#8ec390", innerArray[2], innerArray[3], innerArray[4], "M", i)
                }

                var marketing_solb_list = {{marketing_solb_list|safe}}
                for (let i = 0; i < marketing_solb_list.length; i++) {
                    let innerArray = marketing_solb_list[i];
                    addCustomTd("marketing_solb_tr", String(innerArray[5]).slice(-2) + "-" + String(innerArray[6]), String(innerArray[7]).slice(-2) + "-" + String(innerArray[8]), innerArray[0], "#404fff", innerArray[2], innerArray[3], innerArray[4], "M", i)
                }
            }

            // function addCustomTd(tr, start, end, title, color, content, stdt, endt, gubun) {
            //     const trElement = document.getElementById(tr);
            //
            //     if (trElement) {
            //         const tdElements = trElement.getElementsByTagName("td");
            //         let tdStartIndex = Array.from(tdElements).findIndex(td => td.id === start);
            //         let tdEndIndex = Array.from(tdElements).findIndex(td => td.id === end);
            //         if (tdStartIndex === -1) {
            //             tdStartIndex = 0;
            //         }
            //
            //         if (tdEndIndex === -1) {
            //             tdEndIndex = tdElements.length - 1;
            //         }
            //         const firstTdElement = tdElements[0];
            //         const tdWidth = window.getComputedStyle(firstTdElement).width;
            //
            //         const tdCount = tdEndIndex - tdStartIndex + 1;
            //         const resultDivWidth = (tdWidth * tdCount) + "px";
            //
            //         const newTd = document.createElement("td");
            //         newTd.setAttribute("style", "position: relative;");
            //         newTd.setAttribute("colspan", tdCount);
            //         const margin = (tdCount * tdWidth) + "px";
            //         const newDiv = document.createElement("div");
            //         newDiv.setAttribute("class", "div_info " + end)
            //         newDiv.setAttribute("data-info", title)
            //         newDiv.setAttribute("style", "position: absolute; top: 50%; left: 0; right: 0; background-color:" + color + "; " + "transform: translateY(-50%); text-align: center; cursor: pointer; display: flex; align-items: center; justify-content: center; height: 40px; border-radius: 10px; color: #fff; font-weight: 800;overflow: hidden;text-overflow: ellipsis;");
            //         newDiv.setAttribute("onclick", "season_modal('" + String(content).replace("\r\n", " ") + "', '" + title + "', '" + stdt + "', '" + endt + "', '" + gubun + "')");
            //         newDiv.innerText = title;
            //
            //
            //         newTd.appendChild(newDiv);
            //
            //         for (let i = tdEndIndex; i >= tdStartIndex; i--) {
            //             trElement.removeChild(tdElements[i]);
            //         }
            //
            //         trElement.insertBefore(newTd, tdElements[tdStartIndex]);
            //     }
            // }
            function addCustomTd(tr, start, end, title, color, content, stdt, endt, gubun, _index) {
                let trElement = "";
                if(tr.includes("marketing")) {
                    trElement = document.getElementById("marketing_tr");
                    start = "m-" + String(start)
                    end = "m-" + String(end)
                }else {
                    trElement = document.getElementById("season_tr");
                    start = "s-" + String(start)
                    end = "s-" + String(end)
                }

                if (trElement) {
                    const tdElements = trElement.getElementsByTagName("th");
                    let tdStartIndex = Array.from(tdElements).findIndex(th => th.id === start);
                    let tdEndIndex = Array.from(tdElements).findIndex(th => th.id === end);

                    if (tdStartIndex === -1 && tdEndIndex === -1) {
                        return false;
                    }

                    const currentDate = new Date();
                    const currentYear = parseInt(currentDate.getFullYear());
                    const currentMonth = parseInt(currentDate.getMonth()) + 1;
                    var html = ""
                    var data_week = new Array()
                    var data_month = new Array()
                    for (let i = 3; i > 0; i--) {
                        let month, year;
                        if (currentMonth - i < 1) {
                            month = (12 - (currentMonth - i)).toString().padStart(2, '0');
                            year = currentYear - 1;
                        } else {
                            month = (currentMonth - i).toString().padStart(2, '0');
                            year = currentYear;
                        }

                        data_week.push(weeksInMonth(year, month));
                        data_month.push(month);
                    }

                    data_week.push(weeksInMonth(currentYear, currentMonth))
                    data_month.push((parseInt(currentDate.getMonth()) + 1).toString().padStart(2, '0'))
                    for (let i = 1; i <= 3; i++) {
                        let month, year;
                        if (currentMonth + i > 12) {
                            month = (currentMonth + i - 12).toString().padStart(2, '0');
                            year = currentYear + 1;
                        } else {
                            month = (currentMonth + i).toString().padStart(2, '0');
                            year = currentYear;
                        }
                        data_week.push(weeksInMonth(year, month));
                        data_month.push(month);
                    }
                    let start_idx = start.split("-")[1]
                    let index = data_month.indexOf(start_idx);
                    let _color = "";
                    if (index === -1) {
                        index = 0
                    }

                    if (tr.includes('venus')) {
                        _color = calendar_color_func("V", index)
                    } else if (tr.includes('solb')) {
                        _color = calendar_color_func("S", index)
                    } else {
                        _color = calendar_color_func("W", index)
                    }

                    if (tdStartIndex === -1) {
                        tdStartIndex = 0;
                    }

                    if (tdEndIndex === -1) {
                        tdEndIndex = tdElements.length - 1;
                    }

                    let margin_left_width = 0;
                    let resultDivWidth = 0;

                    for (var j = 0; j < tdStartIndex; j++) {
                        var computedStyle = window.getComputedStyle(tdElements[j]);
                        var width = computedStyle.getPropertyValue("width");
                        margin_left_width += parseFloat(width)
                    }

                    for (var j = tdStartIndex; j <= tdEndIndex; j++) {
                        var computedStyle = window.getComputedStyle(tdElements[j]);
                        var width = computedStyle.getPropertyValue("width");
                        resultDivWidth += parseFloat(width)
                    }

                    const tdCount = tdEndIndex - tdStartIndex + 1;
                    const margin = "; margin-left: " + (margin_left_width) + "px;"
                    const newDiv = document.createElement("div");
                    newDiv.setAttribute("class", "div_info");
                    newDiv.setAttribute("data-info", title);
                    newDiv.setAttribute("data-stdt", stdt);
                    newDiv.setAttribute("data-endt", endt);
                    newDiv.setAttribute("style", "background-color:" + _color + "; " + "text-align: center; cursor: pointer; display: flex; align-items: center; justify-content: center; border-radius: 10px; color: #333; font-weight: 800; overflow: hidden; text-overflow: ellipsis; height:40px; white-space: nowrap; width: " + resultDivWidth + "px; " + margin);

                    newDiv.addEventListener("click", function () {
                        season_modal(String(content).replace("\r\n", " "), title, stdt, endt, gubun);
                    });
                    $("#"+ tr).children("td").append(newDiv);
                    newDiv.innerText = title;
                    const isTextOverflowing = newDiv.scrollWidth > newDiv.clientWidth;

                    if (isTextOverflowing) {
                        if(tdCount < 3) {
                                if (tr.includes('venus')) {
                                    newDiv.innerText = "V"
                                } else if (tr.includes('solb')) {
                                    newDiv.innerText = "S"
                                } else {
                                    newDiv.innerText = "W"
                                }
                        }else {
                                const startIndex = 0;
                                const endIndex = (tdCount * 3);
                                const slicedText = title.slice(startIndex, endIndex);
                                newDiv.innerText = slicedText;
                        }
                    }
                }
            }

            function test() {
				$(".table_view_static").css('display', 'none')
				$(".chart_test").css('display', 'block')
				$("#chart_display").css('display', 'block')
			}

			$("#chart_display").click(function () {
				$("#chart_display").css('display', 'none')
				$(".table_view_static").css('display', 'block')
				$(".chart_test").css('display', 'none')
			})

			function dept_detail(name, code, ecYn) {
                let url = "";
                if(ecYn == "None") {
                    url = "/venus/dashboard_detail_none";
                }else if(ecYn == "EC"){
                    url = "/venus/dashboard_detail_ec";
                }else {
                    url = "/venus/dashboard_detail";
                }

                $.ajax({
                    url: url,
                    type: "get",
                    data: {"code": code, "name": name},
                    success: function (data) {
                        if(ecYn == "EC") {
                            dashboardDetailEcynEc(data, `${name} (EC)`)
                        }else if(ecYn == "None") {
                            dashboardDetailEcynNone(data, `${name} (EC제외)`)
                        }else {
                            dashboardDetailEcynDefault(data, name)
                        }

                    }
                });
			}

			function dash_click(dept) {
                $("#dept_modal").empty()
                if(dept == "SOLB") {
                    var solb_dept_list = {{solb_dept_list|safe}}
                    var html = "";
                    for (let i = 0; i < solb_dept_list.length; i++) {
                        let innerArray = solb_dept_list[i];
                        html += `
                            <tr>
                                <th>
                                            <a href="#" class="text-dark fw-bolder mb-1 fs-6 cursor-s-d">${innerArray[0]}</a>
                                </th>
                                <th>
                                    <a href="#" class="text-dark fw-bolder d-block mb-1 fs-6 cursor-s-d">${innerArray[1]}</a>
                                </th>
                                <th>
                                    <a href="#" class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6"  style="text-align: center;" onclick="dept_detail('${innerArray[2]}', '${innerArray[1]}')">${innerArray[2]}</a>
                                </th>
                                <th>
                                    <a href="#" class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6"  style="text-align: center;"  onclick="dept_detail('${innerArray[2]}', '${innerArray[1]}', 'EC')">${innerArray[2]} (EC)</a>
                                </th>
                                <th>
                                    <a href="#" class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6"  style="text-align: center;"  onclick="dept_detail('${innerArray[2]}', '${innerArray[1]}', 'None')">${innerArray[2]} (EC제외)</a>
                                </th>
                            </tr>
                        `
                    }
                }else if(dept == "VENUS") {
                    var venus_dept_list = {{venus_dept_list|safe}}
                    var html = "";
                    for (let i = 0; i < venus_dept_list.length; i++) {
                        let innerArray = venus_dept_list[i];
                        html += `
                            <tr>
                                <th>
                                            <a href="#" class="text-dark fw-bolder mb-1 fs-6 cursor-s-d">${innerArray[0]}</a>
                                </th>
                                <th>
                                    <a href="#" class="text-dark fw-bolder d-block mb-1 fs-6 cursor-s-d">${innerArray[1]}</a>
                                </th>
                                <th>
                                    <a href="#" class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6"  style="text-align: center;" onclick="dept_detail('${innerArray[2]}', '${innerArray[1]}')">${innerArray[2]}</a>
                                </th>
                                <th>
                                    <a href="#" class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6"  style="text-align: center;"  onclick="dept_detail('${innerArray[2]}', '${innerArray[1]}', 'EC')">${innerArray[2]} (EC)</a>
                                </th>
                                <th>
                                    <a href="#" class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6"  style="text-align: center;"  onclick="dept_detail('${innerArray[2]}', '${innerArray[1]}', 'None')">${innerArray[2]} (EC제외)</a>
                                </th>
                            </tr>
                        `
                        }
                }else if(dept == "WACOAL") {
                        var wacoal_dept_list = {{wacoal_dept_list|safe}}
                        var html = "";
                        for (let i = 0; i < wacoal_dept_list.length; i++) {
                            let innerArray = wacoal_dept_list[i];
                            html += `
                                <tr>
                                    <th>
                                                <a href="#" class="text-dark fw-bolder mb-1 fs-6 cursor-s-d">${innerArray[0]}</a>
                                    </th>
                                    <th>
                                        <a href="#" class="text-dark fw-bolder d-block mb-1 fs-6 cursor-s-d">${innerArray[1]}</a>
                                    </th>
                                    <th>
                                        <a href="#" class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6"  style="text-align: center;" onclick="dept_detail('${innerArray[2]}', '${innerArray[1]}')">${innerArray[2]}</a>
                                    </th>
                                    <th>
                                        <a href="#" class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6" style="text-align: center;"  onclick="dept_detail('${innerArray[2]}', '${innerArray[1]}', 'EC')">${innerArray[2]} (EC)</a>
                                    </th>
                                    <th>
                                        <a href="#" class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6"  style="text-align: center;"  onclick="dept_detail('${innerArray[2]}', '${innerArray[1]}', 'None')">${innerArray[2]} (EC제외)</a>
                                    </th>
                                </tr>
                            `
                        }
                }
                $("#dept_modal").append(html)
				$('#kt_modal_create_app').css("display", "block")
				$('#kt_modal_create_app').removeClass('fade').addClass('show');
			}

			$(".delete_btn").click(function () {
				$('#kt_modal_create_app').css("display", "none")
				$('#kt_modal_create_app').removeClass('show').addClass('fade');
			})

		</script>

<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://unpkg.com/file-saver/dist/FileSaver.min.js"></script>

<script>


    function exportTableToExcel() {
        var table = document.getElementById("my_table");
        var wb = XLSX.utils.table_to_book(table, {raw: true});
        var wbout = XLSX.write(wb, {bookType: 'xlsx', bookSST: true, type: 'binary'});

	function s2ab(s) {
		var buf = new ArrayBuffer(s.length);
		var view = new Uint8Array(buf);
		for (var i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
		return buf;
	}

        saveAs(new Blob([s2ab(wbout)], {type: "application/octet-stream"}), '생산_판매_재고_계획.xlsx');
    }

    $(".delete_season_btn").click(function () {
        $('#kt_modal_app').css("display", "none")
        $('#kt_modal_app').removeClass('show').addClass('fade');
    })

    function season_modal(content, title, stdt, endt, gubun) {
        document.querySelectorAll('.infoBox').forEach(e => e.remove());

        $("#kt_modal_app_title").text(content)
        $("#season_file").empty()
        $.ajax({
			url: "/venus/file_search_url",
			type: "get",
			data: {"stdt": stdt, "endt": endt, "title": title, "gubun": gubun},
			success: function (data) {
                if(data.proc == "fail") {
                    alert(data.msg);
                    return false;
                }
                var file_list = data.file_list;
                if(file_list.length < 1) {
                    var html = `<tr><th colspan="4"><a href="#" class="text-dark fw-bolder d-block mb-1 fs-6 cursor-s-d" style="text-align: center;">조회되는 파일이 없습니다.</a></th></tr>`
                }else {
                    var html = ""
                    for (let i = 0; i < file_list.length; i++) {
                        let innerArray = file_list[i];

                        html += `
                            <tr>
                                <th>
                                    <a href="#" class="text-dark fw-bolder d-block mb-1 fs-6 cursor-s-d"  style="text-align: center;">${i + 1}</a>
                                </th>
                                <th>
                                    <a href="#" class="text-dark fw-bolder d-block mb-1 fs-6 cursor-s-d">${innerArray[0]}</a>
                                </th>
                                <th>
                                    <a href="#" class="text-dark fw-bolder text-hover-primary d-block mb-1 fs-6" onclick="file_web('${innerArray[1]}')">${String(innerArray[1]).split('/').pop()}</a>
                                </th>
                                <th>
                                    <a href="#" class="text-dark fw-bolder d-block mb-1 fs-6 cursor-s-d"></a>
                                </th>
                            </tr>
                        `
                    }
                }
                $("#season_file").append(html)

			}
		});
        $('#kt_modal_app').css("display", "block")
        $('#kt_modal_app').removeClass('fade').addClass('show');
    }


    $(".delete_season_calendar_btn").click(function () {
        $('#kt_modal_app_season_calendar').css("display", "none")
        $('#kt_modal_app_season_calendar').removeClass('show').addClass('fade');
    })

    function app_season_calendar() {
        $('#kt_modal_app_season_calendar').css("display", "block")
        $('#kt_modal_app_season_calendar').removeClass('fade').addClass('show');
    }


    function numberWithCommas(x) {
        return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    }

    function file_web(url) {
        window.open(`/venus/file-web/?url=${encodeURIComponent(url)}`, "_blank");
    }

    function handleClick(event) {
      event.stopPropagation();
      const target = $(event.target);
      let plus = parseInt(target.text().replaceAll("+",""));
      for(let i=1; i<=plus; i++) {
          console.log(target.data("date" + String(i)));
      }
      app_season_calendar()
    }

    function app_season_calendar_file() {
        $('#kt_modal_app_season_calendar').css("display", "none")
        $('#kt_modal_app_season_calendar').removeClass('show').addClass('fade');
        season_modal();
    }




    function dashboardDetailEcynDefault(data, name){
                            let month = ""
                            let data_row_1 = ""
                            let data_row_2 = ""
                            let data_row_3 = ""
                            let data_row_4 = ""
                            let data_row_5 = ""
                            let data_row_6 = ""
                            let data_row_7 = ""
                            let data_row_8 = ""
                            let data_row_9 = ""
                            let data_row_10 = ""
                            let data_row_11 = ""
                            let data_row_12 = ""
                            let data_row_13 = ""
                            let data_row_14 = ""
                            let data_row_15 = ""
                            let data_row_16 = ""
                            let data_row_17 = ""
                            let data_row_18 = ""
                            let data_row_19 = ""
                            if(data.proc == "success") {
                                // $("body").empty()
                                for(let i=0; i<data.month.length; i++) {
                                    let monthValue = data.month[i];
                                    month += `<th class="min-w-75px" style="text-align: center !important;">${monthValue}</th>`;
                                }
                                var targetString = '1~12월 계';
                                var indexOfTarget = data.month.indexOf(targetString);
                                let cal_a, cal_b, cal_c, cal_d, cal_e, cal_f, cal_g, cal_h, cal_i, cal_j, cal_k, cal_l;
                                console.log("indexOfTarget : " + indexOfTarget)
                                for (let i = 1; i <= data.list.length; i++) {
                                    let value = data.list[i-1];
                                    let sum = 0;
                                    value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                    console.log(value);
                                    // "재고" include 되는 경우 -> 인덱스-1 의 재고 데이터를 1~12계 합계로 사용.
                                    // TODO
                                    for(let j=2; j< value.length; j++) {
                                        if(i == 1) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _sum = value[(parseInt(indexOfTarget) + 2)]
                                                data_row_1 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + value[j]
                                                    data_row_1 += `<td>${numberWithCommas(value[j])}</td>`
                                                    data_row_1 += `<td class='current-m1'>${numberWithCommas(sum)}</td>`
                                                    cal_a = sum
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + value[j]
                                                    data_row_1 += `<td>${numberWithCommas(value[j])}</td>`
                                                } else {
                                                    data_row_1 += `<td>${numberWithCommas(value[j])}</td>`
                                                }
                                            }
                                        }else if(i == 2) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_2 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + value[j]
                                                    data_row_2 += `<td>${numberWithCommas(value[j])}</td>`
                                                    data_row_2 += `<td class='current-m1'>${numberWithCommas(sum)}</td>`
                                                    cal_b = sum
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + value[j]
                                                    data_row_2 += `<td>${numberWithCommas(value[j])}</td>`
                                                } else {
                                                    data_row_2 += `<td>${numberWithCommas(value[j])}</td>`
                                                }
                                            }
                                        }else if(i == 3) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_3 += `<td class='current-m1'>${numberWithCommas(_sum)}%</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                // sum = sum + parseFloat(value[j])
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + parseFloat(value[j])
                                                    data_row_3 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    // let avg = value.length - (parseInt(indexOfTarget + 2) + 1)
                                                    data_row_3 += `<td class='current-m1'>${calculateRatio(cal_b, cal_a)}%</td>`
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + parseFloat(value[j])
                                                    data_row_3 += `<td>${numberWithCommas(value[j])}%</td>`
                                                } else {
                                                    data_row_3 += `<td>${numberWithCommas(value[j])}%</td>`
                                                }
                                            }
                                        }else if(i == 4) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_4 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {

                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + value[j]
                                                    data_row_4 += `<td>${numberWithCommas(value[j])}</td>`
                                                    data_row_4 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                                    cal_c = value[j]
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + value[j]
                                                    data_row_4 += `<td>${numberWithCommas(value[j])}</td>`
                                                } else {
                                                    data_row_4 += `<td>${numberWithCommas(value[j])}</td>`
                                                }
                                            }
                                        }else if(i == 5) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_5 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + value[j]
                                                    data_row_5 += `<td>${numberWithCommas(value[j])}</td>`
                                                    data_row_5 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                                    cal_d = value[j]
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + value[j]
                                                    data_row_5 += `<td>${numberWithCommas(value[j])}</td>`
                                                } else {
                                                    data_row_5 += `<td>${numberWithCommas(value[j])}</td>`
                                                }
                                            }
                                        }else if(i == 6) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_6 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {

                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + value[j]
                                                    data_row_6 += `<td>${numberWithCommas(value[j])}</td>`
                                                    data_row_6 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                                    cal_e = value[j]
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + value[j]
                                                    data_row_6 += `<td>${numberWithCommas(value[j])}</td>`
                                                } else {
                                                    data_row_6 += `<td>${numberWithCommas(value[j])}</td>`
                                                }
                                            }
                                        }else if(i == 7) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_7 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + value[j]
                                                    data_row_7 += `<td>${numberWithCommas(value[j])}</td>`
                                                    data_row_7 += `<td class='current-m1'>${numberWithCommas(sum)}</td>`
                                                    cal_f = sum
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + value[j]
                                                    data_row_7 += `<td>${numberWithCommas(value[j])}</td>`
                                                } else {
                                                    data_row_7 += `<td>${numberWithCommas(value[j])}</td>`
                                                }
                                            }
                                        }else if(i == 8) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_8 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + value[j]
                                                    data_row_8 += `<td>${numberWithCommas(value[j])}</td>`
                                                    data_row_8 += `<td class='current-m1'>${numberWithCommas(sum)}</td>`
                                                    cal_g = sum
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + value[j]
                                                    data_row_8 += `<td>${numberWithCommas(value[j])}</td>`
                                                } else {
                                                    data_row_8 += `<td>${numberWithCommas(value[j])}</td>`
                                                }
                                            }
                                        }else if(i == 9) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_9 += `<td class='current-m1'>${numberWithCommas(_sum)}%</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + parseFloat(value[j])
                                                    data_row_9 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    // let avg = value.length - (parseInt(indexOfTarget + 2) + 1)
                                                    data_row_9 += `<td class='current-m1'>${calculateRatio(cal_g, cal_f)}%</td>`
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + parseFloat(value[j])
                                                    data_row_9 += `<td>${numberWithCommas(value[j])}%</td>`
                                                } else {
                                                    data_row_9 += `<td>${numberWithCommas(value[j])}%</td>`
                                                }
                                            }
                                        }else if(i == 10) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_10 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + value[j]
                                                    data_row_10 += `<td>${numberWithCommas(value[j])}</td>`
                                                    data_row_10 += `<td class='current-m1'>${numberWithCommas(sum)}</td>`
                                                    cal_h = sum
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + value[j]
                                                    data_row_10 += `<td>${numberWithCommas(value[j])}</td>`
                                                } else {
                                                    data_row_10 += `<td>${numberWithCommas(value[j])}</td>`
                                                }
                                            }
                                        }else if(i == 11) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_11 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + value[j]
                                                    data_row_11 += `<td>${numberWithCommas(value[j])}</td>`
                                                    data_row_11 += `<td class='current-m1'>${numberWithCommas(sum)}</td>`
                                                    cal_i = sum
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + value[j]
                                                    data_row_11 += `<td>${numberWithCommas(value[j])}</td>`
                                                } else {
                                                    data_row_11 += `<td>${numberWithCommas(value[j])}</td>`
                                                }
                                            }
                                        }else if(i == 12) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_12 += `<td class='current-m1'>${numberWithCommas(_sum)}%</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + parseFloat(value[j])
                                                    data_row_12 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    // let avg = value.length - (parseInt(indexOfTarget + 2) + 1)
                                                    data_row_12 += `<td class='current-m1'>${calculateRatio(cal_i, cal_h)}%</td>`
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + parseFloat(value[j])
                                                    data_row_12 += `<td>${numberWithCommas(value[j])}%</td>`
                                                } else {
                                                    data_row_12 += `<td>${numberWithCommas(value[j])}%</td>`
                                                }
                                            }
                                        }else if(i == 13) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_13 += `<td class='current-m1'>${numberWithCommas(_sum)}%</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + parseFloat(value[j])
                                                    data_row_13 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    // let avg = value.length - (parseInt(indexOfTarget + 2) + 1)
                                                    data_row_13 += `<td class='current-m1'>${calculateRatio(cal_i, cal_b)}%</td>`
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + parseFloat(value[j])
                                                    data_row_13 += `<td>${numberWithCommas(value[j])}%</td>`
                                                } else {
                                                    data_row_13 += `<td>${numberWithCommas(value[j])}%</td>`
                                                }
                                            }
                                        }else if(i == 14) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_14 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + value[j]
                                                    data_row_14 += `<td>${numberWithCommas(value[j])}</td>`
                                                    data_row_14 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                                    cal_j = value[j]
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + value[j]
                                                    data_row_14 += `<td>${numberWithCommas(value[j])}</td>`
                                                } else {
                                                    data_row_14 += `<td>${numberWithCommas(value[j])}</td>`
                                                }
                                            }
                                        }else if(i == 15) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_15 += `<td class='current-m1'>${numberWithCommas(_sum)}%</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + parseFloat(value[j])
                                                    data_row_15 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    // let avg = value.length - (parseInt(indexOfTarget + 2) + 1)
                                                    data_row_15 += `<td class='current-m1'>${calculateRatio(cal_j, cal_c)}%</td>`
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + parseFloat(value[j])
                                                    data_row_15 += `<td>${numberWithCommas(value[j])}%</td>`
                                                } else {
                                                    data_row_15 += `<td>${numberWithCommas(value[j])}%</td>`
                                                }
                                            }
                                        }else if(i == 16) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_16 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + value[j]
                                                    data_row_16 += `<td>${numberWithCommas(value[j])}</td>`
                                                    data_row_16 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                                    cal_k = value[j]
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + value[j]
                                                    data_row_16 += `<td>${numberWithCommas(value[j])}</td>`
                                                } else {
                                                    data_row_16 += `<td>${numberWithCommas(value[j])}</td>`
                                                }
                                            }
                                        }else if(i == 17) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_17 += `<td class='current-m1'>${numberWithCommas(_sum)}%</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + parseFloat(value[j])
                                                    data_row_17 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    // let avg = value.length - (parseInt(indexOfTarget + 2) + 1)
                                                    data_row_17 += `<td class='current-m1'>${calculateRatio(cal_k, cal_d)}%</td>`
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + parseFloat(value[j])
                                                    data_row_17 += `<td>${numberWithCommas(value[j])}%</td>`
                                                } else {
                                                    data_row_17 += `<td>${numberWithCommas(value[j])}%</td>`
                                                }
                                            }
                                        }else if(i == 18) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_18 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + value[j]
                                                    data_row_18 += `<td>${numberWithCommas(value[j])}</td>`
                                                    data_row_18 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                                    cal_l = value[j]
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + value[j]
                                                    data_row_18 += `<td>${numberWithCommas(value[j])}</td>`
                                                } else {
                                                    data_row_18 += `<td>${numberWithCommas(value[j])}</td>`
                                                }
                                            }
                                        }else if(i == 19) {
                                            if(j == (indexOfTarget + 2)) {
                                                let _idx = indexOfTarget + 2
                                                let _sum = value[_idx]
                                                data_row_19 += `<td class='current-m1'>${numberWithCommas(_sum)}%</td>`
                                                // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                            }else {
                                                if (j == parseInt(value.length) - 1) {
                                                    sum = sum + parseFloat(value[j])
                                                    data_row_19 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    // let avg = value.length - (parseInt(indexOfTarget + 2) + 1)
                                                    data_row_19 += `<td class='current-m1'>${calculateRatio(cal_l, cal_e)}%</td>`
                                                }else if(j > (indexOfTarget + 2)) {
                                                    sum = sum + parseFloat(value[j])
                                                    data_row_19 += `<td>${numberWithCommas(value[j])}%</td>`
                                                } else {
                                                    data_row_19 += `<td>${numberWithCommas(value[j])}%</td>`
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            let year = "{{year}}"
                            let html = `
                              <div class="d-flex flex-column flex-root">
                                   <!--begin::Page-->
                                   <div class="page d-flex flex-row flex-column-fluid">
                                    <div class="d-flex flex-column flex-row-fluid" id="kt_wrapper">
                                     <div class="content d-flex flex-column flex-column-fluid" id="kt_content">
                                      <!--end::Toolbar-->
                                      <div class="post d-flex flex-column-fluid" id="kt_post">
                                       <div id="kt_content_container" class="container-xxl">
                                <span class="nav-link btn-color-muted btn-active btn-active-light-primary active fw-bolder" style="cursor:pointer" onclick="location.href='/venus/web-tab/?source=kusrc_heroku_prod'" >돌아가기</span>
                                     <div class="card mb-5 mb-xl-8">
                                     <!--begin::Header-->
                                     <div class="card-header border-0 pt-5">
                                      <h3 class="card-title align-items-start flex-column">
                                       <span class="card-label fw-bolder fs-3 mb-1">생산 판매 재고 계획 [ ${name} ]</span>
                                       <span class="text-muted mt-1 fw-bold fs-7"></span>
                                      </h3>
                                      <div class="card-toolbar">

                                       <!--begin::Menu 2-->
                                       <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fw-bold w-200px" data-kt-menu="true">
                                        <!--begin::Menu item-->
                                        <div class="menu-item px-3">
                                         <div class="menu-content fs-6 text-dark fw-bolder px-3 py-4">Dashboard</div>
                                        </div>
                                        <!--end::Menu item-->
                                        <!--begin::Menu separator-->
                                        <div class="separator mb-3 opacity-75"></div>
                                        <!--end::Menu separator-->
                                        <!--begin::Menu item-->
                                        <div class="menu-item px-3">
                                         <a href="#" class="menu-link px-3" onclick="test()">차트로 내용 보기</a>
                                        </div>
                                        <div class="separator mb-3 opacity-75"></div>
                                       </div>
                                       <!--end::Menu 2-->
                                       <!--end::Menu-->
                                      </div>
                                     </div>
                                     <!--end::Header-->
                                     <!--begin::Body-->
                                     <div class="card-body py-3" class="table_view_static">
                                      <!--begin::Table container-->
                                      <div class="table-responsive">
                                       <!--begin::Table-->
                                       <table class="table align-middle gs-0 gy-4" id="dept_my_table">
                                        <!--begin::Table head-->
                                        <thead>
                                         <tr class="fw-bolder text-muted bg-light">
                                          <th class="ps-4 min-w-200px rounded-start" colspan="3">구분</th>
                                                    ${month}
                                         </tr>
                                        </thead>
                                        <!--end::Table head-->
                                        <!--begin::Table body-->
                                        <tbody>
                                            <tr>
                                                <td rowspan="6" class ="br-2">${year-1}년</td>
                                                <td colspan="2" class ="br-2">총생산량</td>
                                                    ${data_row_1}
                                              </tr>
                                              <tr>
                                                <td colspan="2" class ="br-2">실판매량</td>
                                                    ${data_row_2}
                                              </tr>
                                              <tr>
                                                <td colspan="2" class ="br-2">%</td>
                                                    ${data_row_3}
                                              </tr>
                                              <tr>
                                                <td colspan="2" class ="br-2">총재고(상품수량)</td>
                                                    ${data_row_4}
                                              </tr>
                                              <tr>
                                                <td colspan="2" class ="br-2">정품재고금액</td>
                                                    ${data_row_5}
                                              </tr>
                                              <tr>
                                                <td colspan="2" class ="br-2">이등품재고금액</td>
                                                    ${data_row_6}
                                              </tr>
                                              <tr>
                                                <td rowspan="13" class="br-2 br-1-0">${year}년</td>
                                                <td rowspan="3" class ="br-2 br-1-0">생산</td>
                                                <td class ="br-2">목표량</td>
                                                    ${data_row_7}
                                              </tr>
                                              <tr>
                                                <td class ="br-2">생산량</td>
                                                    ${data_row_8}
                                              </tr>
                                              <tr>
                                                <td class ="br-2">목표%</td>
                                                    ${data_row_9}
                                              </tr>
                                              <tr>
                                                <td rowspan="4" class ="br-2 br-1-0">실판매</td>
                                                <td class ="br-2">목표량</td>
                                                    ${data_row_10}
                                              </tr>
                                              <tr>
                                                <td class ="br-2">판매량</td>
                                                    ${data_row_11}
                                              </tr>
                                              <tr>
                                                <td class ="br-2">목표%</td>
                                                    ${data_row_12}
                                              </tr>
                                              <tr>
                                                <td class ="br-2">전년%</td>
                                                    ${data_row_13}
                                              </tr>
                                              <tr>
                                                <td rowspan="2" class ="br-2 br-1-0">총재고<br>(정품<br>수량)</td>
                                                <td class ="br-2">재고량</td>
                                                    ${data_row_14}
                                              </tr>
                                              <tr>
                                                <td class ="br-2">전년%</td>
                                                    ${data_row_15}
                                              </tr>
                                              <tr>
                                                <td rowspan="2" class ="br-2 br-1-0">정품재고<br>금액</td>
                                                <td class ="br-2">재고금액</td>
                                                    ${data_row_16}
                                              </tr>
                                              <tr>
                                                <td class ="br-2">전년%</td>
                                                    ${data_row_17}
                                              </tr>
                                              <tr>
                                                <td rowspan="2" class ="br-2 br-1-0">이등품<br>재고금액</td>
                                                <td class ="br-2">재고금액</td>
                                                    ${data_row_18}
                                              </tr>
                                              <tr>
                                                <td class ="br-2 br-1-0">전년%</td>
                                                    ${data_row_19}
                                              </tr>

                                        </tbody>
                                        <!--end::Table body-->
                                       </table>
                                       <!--end::Table-->
                                      </div>
                                      <!--end::Table container-->
                                     </div>
                                </div>
                                </div>
                                </div>
                                </div>
                                </div>
                                </div>
                            `
                        $("body").empty()
                        $("body").append(html)
                    }
    function dashboardDetailEcynNone(data, name){
                                let month = ""
                                let data_row_1 = ""
                                let data_row_2 = ""
                                let data_row_3 = ""
                                let data_row_4 = ""
                                let data_row_5 = ""
                                let data_row_6 = ""
                                let data_row_7 = ""
                                let data_row_8 = ""
                                let data_row_9 = ""
                                let data_row_10 = ""
                                let data_row_11 = ""
                                let data_row_12 = ""
                                let data_row_13 = ""
                                let data_row_14 = ""
                                let data_row_15 = ""
                                let data_row_16 = ""
                                let data_row_17 = ""
                                let data_row_18 = ""
                                let data_row_19 = ""
                                if(data.proc == "success") {
                                    // $("body").empty()
                                    for(let i=0; i<data.month.length; i++) {
                                        let monthValue = data.month[i];
                                        month += `<th class="min-w-75px" style="text-align: center !important;">${monthValue}</th>`;
                                    }
                                    var targetString = '1~12월 계';
                                    var indexOfTarget = data.month.indexOf(targetString);
                                    let cal_a, cal_b, cal_c, cal_d, cal_e, cal_f, cal_g, cal_h, cal_i, cal_j, cal_k, cal_l;

                                    for (let i = 1; i <= data.list.length; i++) {
                                        let value = data.list[i-1];
                                        let sum = 0;
                                        value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                        for (let j = 2; j < value.length; j++) {
                                            if (i == 1) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _sum = value[(parseInt(indexOfTarget) + 2)]
                                                    data_row_1 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + value[j]
                                                        data_row_1 += `<td>${numberWithCommas(value[j])}</td>`
                                                        data_row_1 += `<td class='current-m1'>${numberWithCommas(sum)}</td>`
                                                        cal_a = sum
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + value[j]
                                                        data_row_1 += `<td>${numberWithCommas(value[j])}</td>`
                                                    } else {
                                                        data_row_1 += `<td>${numberWithCommas(value[j])}</td>`
                                                    }
                                                }
                                            } else if (i == 2) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_2 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + value[j]
                                                        data_row_2 += `<td>${numberWithCommas(value[j])}</td>`
                                                        data_row_2 += `<td class='current-m1'>${numberWithCommas(sum)}</td>`
                                                        cal_b = sum
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + value[j]
                                                        data_row_2 += `<td>${numberWithCommas(value[j])}</td>`
                                                    } else {
                                                        data_row_2 += `<td>${numberWithCommas(value[j])}</td>`
                                                    }
                                                }
                                            } else if (i == 3) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_3 += `<td class='current-m1'>${numberWithCommas(_sum)}%</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    // sum = sum + parseFloat(value[j])
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + parseFloat(value[j])
                                                        data_row_3 += `<td>${numberWithCommas(value[j])}%</td>`
                                                        // let avg = value.length - (parseInt(indexOfTarget + 2) + 1)
                                                        data_row_3 += `<td class='current-m1'>${calculateRatio(cal_b, cal_a)}%</td>`
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + parseFloat(value[j])
                                                        data_row_3 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    } else {
                                                        data_row_3 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    }
                                                }
                                            } else if (i == 4) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_4 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {

                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + value[j]
                                                        data_row_4 += `<td>${numberWithCommas(value[j])}</td>`
                                                        data_row_4 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                                        cal_c = value[j]
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + value[j]
                                                        data_row_4 += `<td>${numberWithCommas(value[j])}</td>`
                                                    } else {
                                                        data_row_4 += `<td>${numberWithCommas(value[j])}</td>`
                                                    }
                                                }
                                            } else if (i == 5) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_5 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + value[j]
                                                        data_row_5 += `<td>${numberWithCommas(value[j])}</td>`
                                                        data_row_5 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                                        cal_d = value[j]
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + value[j]
                                                        data_row_5 += `<td>${numberWithCommas(value[j])}</td>`
                                                    } else {
                                                        data_row_5 += `<td>${numberWithCommas(value[j])}</td>`
                                                    }
                                                }
                                            } else if (i == 6) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_6 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {

                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + value[j]
                                                        data_row_6 += `<td>${numberWithCommas(value[j])}</td>`
                                                        data_row_6 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                                        cal_e = value[j]
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + value[j]
                                                        data_row_6 += `<td>${numberWithCommas(value[j])}</td>`
                                                    } else {
                                                        data_row_6 += `<td>${numberWithCommas(value[j])}</td>`
                                                    }
                                                }
                                            } else if (i == 7) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_7 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + value[j]
                                                        data_row_7 += `<td>${numberWithCommas(value[j])}</td>`
                                                        data_row_7 += `<td class='current-m1'>${numberWithCommas(sum)}</td>`
                                                        cal_f = sum
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + value[j]
                                                        data_row_7 += `<td>${numberWithCommas(value[j])}</td>`
                                                    } else {
                                                        data_row_7 += `<td>${numberWithCommas(value[j])}</td>`
                                                    }
                                                }
                                            } else if (i == 8) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_8 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + value[j]
                                                        data_row_8 += `<td>${numberWithCommas(value[j])}</td>`
                                                        data_row_8 += `<td class='current-m1'>${numberWithCommas(sum)}</td>`
                                                        cal_g = sum
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + value[j]
                                                        data_row_8 += `<td>${numberWithCommas(value[j])}</td>`
                                                    } else {
                                                        data_row_8 += `<td>${numberWithCommas(value[j])}</td>`
                                                    }
                                                }
                                            } else if (i == 9) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_9 += `<td class='current-m1'>${numberWithCommas(_sum)}%</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + parseFloat(value[j])
                                                        data_row_9 += `<td>${numberWithCommas(value[j])}%</td>`
                                                        // let avg = value.length - (parseInt(indexOfTarget + 2) + 1)
                                                        data_row_9 += `<td class='current-m1'>${calculateRatio(cal_g, cal_f)}%</td>`
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + parseFloat(value[j])
                                                        data_row_9 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    } else {
                                                        data_row_9 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    }
                                                }
                                            } else if (i == 10) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_10 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + value[j]
                                                        data_row_10 += `<td>${numberWithCommas(value[j])}</td>`
                                                        data_row_10 += `<td class='current-m1'>${numberWithCommas(sum)}</td>`
                                                        cal_h = sum
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + value[j]
                                                        data_row_10 += `<td>${numberWithCommas(value[j])}</td>`
                                                    } else {
                                                        data_row_10 += `<td>${numberWithCommas(value[j])}</td>`
                                                    }
                                                }
                                            } else if (i == 11) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_11 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + value[j]
                                                        data_row_11 += `<td>${numberWithCommas(value[j])}</td>`
                                                        data_row_11 += `<td class='current-m1'>${numberWithCommas(sum)}</td>`
                                                        cal_i = sum
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + value[j]
                                                        data_row_11 += `<td>${numberWithCommas(value[j])}</td>`
                                                    } else {
                                                        data_row_11 += `<td>${numberWithCommas(value[j])}</td>`
                                                    }
                                                }
                                            } else if (i == 12) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_12 += `<td class='current-m1'>${numberWithCommas(_sum)}%</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + parseFloat(value[j])
                                                        data_row_12 += `<td>${numberWithCommas(value[j])}%</td>`
                                                        // let avg = value.length - (parseInt(indexOfTarget + 2) + 1)
                                                        data_row_12 += `<td class='current-m1'>${calculateRatio(cal_i, cal_h)}%</td>`
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + parseFloat(value[j])
                                                        data_row_12 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    } else {
                                                        data_row_12 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    }
                                                }
                                            } else if (i == 13) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_13 += `<td class='current-m1'>${numberWithCommas(_sum)}%</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + parseFloat(value[j])
                                                        data_row_13 += `<td>${numberWithCommas(value[j])}%</td>`
                                                        // let avg = value.length - (parseInt(indexOfTarget + 2) + 1)
                                                        data_row_13 += `<td class='current-m1'>${calculateRatio(cal_i, cal_b)}%</td>`
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + parseFloat(value[j])
                                                        data_row_13 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    } else {
                                                        data_row_13 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    }
                                                }
                                            } else if (i == 14) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_14 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + value[j]
                                                        data_row_14 += `<td>${numberWithCommas(value[j])}</td>`
                                                        data_row_14 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                                        cal_j = value[j]
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + value[j]
                                                        data_row_14 += `<td>${numberWithCommas(value[j])}</td>`
                                                    } else {
                                                        data_row_14 += `<td>${numberWithCommas(value[j])}</td>`
                                                    }
                                                }
                                            } else if (i == 15) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_15 += `<td class='current-m1'>${numberWithCommas(_sum)}%</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + parseFloat(value[j])
                                                        data_row_15 += `<td>${numberWithCommas(value[j])}%</td>`
                                                        // let avg = value.length - (parseInt(indexOfTarget + 2) + 1)
                                                        data_row_15 += `<td class='current-m1'>${calculateRatio(cal_j, cal_c)}%</td>`
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + parseFloat(value[j])
                                                        data_row_15 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    } else {
                                                        data_row_15 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    }
                                                }
                                            } else if (i == 16) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_16 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + value[j]
                                                        data_row_16 += `<td>${numberWithCommas(value[j])}</td>`
                                                        data_row_16 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                                        cal_k = value[j]
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + value[j]
                                                        data_row_16 += `<td>${numberWithCommas(value[j])}</td>`
                                                    } else {
                                                        data_row_16 += `<td>${numberWithCommas(value[j])}</td>`
                                                    }
                                                }
                                            } else if (i == 17) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_17 += `<td class='current-m1'>${numberWithCommas(_sum)}%</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + parseFloat(value[j])
                                                        data_row_17 += `<td>${numberWithCommas(value[j])}%</td>`
                                                        // let avg = value.length - (parseInt(indexOfTarget + 2) + 1)
                                                        data_row_17 += `<td class='current-m1'>${calculateRatio(cal_k, cal_d)}%</td>`
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + parseFloat(value[j])
                                                        data_row_17 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    } else {
                                                        data_row_17 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    }
                                                }
                                            } else if (i == 18) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_18 += `<td class='current-m1'>${numberWithCommas(_sum)}</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + value[j]
                                                        data_row_18 += `<td>${numberWithCommas(value[j])}</td>`
                                                        data_row_18 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                                        cal_l = value[j]
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + value[j]
                                                        data_row_18 += `<td>${numberWithCommas(value[j])}</td>`
                                                    } else {
                                                        data_row_18 += `<td>${numberWithCommas(value[j])}</td>`
                                                    }
                                                }
                                            } else if (i == 19) {
                                                if (j == (indexOfTarget + 2)) {
                                                    let _idx = indexOfTarget + 2
                                                    let _sum = value[_idx]
                                                    data_row_19 += `<td class='current-m1'>${numberWithCommas(_sum)}%</td>`
                                                    // value.splice(parseInt(indexOfTarget + 2), 0, value.pop());
                                                } else {
                                                    if (j == parseInt(value.length) - 1) {
                                                        sum = sum + parseFloat(value[j])
                                                        data_row_19 += `<td>${numberWithCommas(value[j])}%</td>`
                                                        // let avg = value.length - (parseInt(indexOfTarget + 2) + 1)
                                                        data_row_19 += `<td class='current-m1'>${calculateRatio(cal_l, cal_e)}%</td>`
                                                    } else if (j > (indexOfTarget + 2)) {
                                                        sum = sum + parseFloat(value[j])
                                                        data_row_19 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    } else {
                                                        data_row_19 += `<td>${numberWithCommas(value[j])}%</td>`
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                                let year = "{{year}}"
                                let html = `
                                  <div class="d-flex flex-column flex-root">
                                       <!--begin::Page-->
                                       <div class="page d-flex flex-row flex-column-fluid">
                                        <div class="d-flex flex-column flex-row-fluid" id="kt_wrapper">
                                         <div class="content d-flex flex-column flex-column-fluid" id="kt_content">
                                          <!--end::Toolbar-->
                                          <div class="post d-flex flex-column-fluid" id="kt_post">
                                           <div id="kt_content_container" class="container-xxl">
                                    <span class="nav-link btn-color-muted btn-active btn-active-light-primary active fw-bolder" style="cursor:pointer" onclick="location.href='/venus/web-tab/?source=kusrc_heroku_prod'" >돌아가기</span>
                                         <div class="card mb-5 mb-xl-8">
                                         <!--begin::Header-->
                                         <div class="card-header border-0 pt-5">
                                          <h3 class="card-title align-items-start flex-column">
                                           <span class="card-label fw-bolder fs-3 mb-1">생산 판매 재고 계획 [ ${name} ]</span>
                                           <span class="text-muted mt-1 fw-bold fs-7"></span>
                                          </h3>
                                          <div class="card-toolbar">

                                           <!--begin::Menu 2-->
                                           <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fw-bold w-200px" data-kt-menu="true">
                                            <!--begin::Menu item-->
                                            <div class="menu-item px-3">
                                             <div class="menu-content fs-6 text-dark fw-bolder px-3 py-4">Dashboard</div>
                                            </div>
                                            <!--end::Menu item-->
                                            <!--begin::Menu separator-->
                                            <div class="separator mb-3 opacity-75"></div>
                                            <!--end::Menu separator-->
                                            <!--begin::Menu item-->
                                            <div class="menu-item px-3">
                                             <a href="#" class="menu-link px-3" onclick="test()">차트로 내용 보기</a>
                                            </div>
                                            <div class="separator mb-3 opacity-75"></div>
                                           </div>
                                           <!--end::Menu 2-->
                                           <!--end::Menu-->
                                          </div>
                                         </div>
                                         <!--end::Header-->
                                         <!--begin::Body-->
                                         <div class="card-body py-3" class="table_view_static">
                                          <!--begin::Table container-->
                                          <div class="table-responsive">
                                           <!--begin::Table-->
                                           <table class="table align-middle gs-0 gy-4" id="dept_my_table">
                                            <!--begin::Table head-->
                                            <thead>
                                             <tr class="fw-bolder text-muted bg-light">
                                              <th class="ps-4 min-w-200px rounded-start" colspan="3">구분</th>
                                                        ${month}
                                             </tr>
                                            </thead>
                                            <!--end::Table head-->
                                            <!--begin::Table body-->
                                            <tbody>
                                                <tr>
                                                    <td rowspan="6" class ="br-2">${year-1}년</td>
                                                    <td colspan="2" class ="br-2">총생산량</td>
                                                        ${data_row_1}
                                                  </tr>
                                                  <tr>
                                                    <td colspan="2" class ="br-2">실판매량</td>
                                                        ${data_row_2}
                                                  </tr>
                                                  <tr>
                                                    <td colspan="2" class ="br-2">%</td>
                                                        ${data_row_3}
                                                  </tr>
                                                  <tr>
                                                    <td colspan="2" class ="br-2">총재고(상품수량)</td>
                                                        ${data_row_4}
                                                  </tr>
                                                  <tr>
                                                    <td colspan="2" class ="br-2">정품재고금액</td>
                                                        ${data_row_5}
                                                  </tr>
                                                  <tr>
                                                    <td colspan="2" class ="br-2">이등품재고금액</td>
                                                        ${data_row_6}
                                                  </tr>
                                                  <tr>
                                                    <td rowspan="13" class="br-2 br-1-0">${year}년</td>
                                                    <td rowspan="3" class ="br-2 br-1-0">생산</td>
                                                    <td class ="br-2">목표량</td>
                                                        ${data_row_7}
                                                  </tr>
                                                  <tr>
                                                    <td class ="br-2">생산량</td>
                                                        ${data_row_8}
                                                  </tr>
                                                  <tr>
                                                    <td class ="br-2">목표%</td>
                                                        ${data_row_9}
                                                  </tr>
                                                  <tr>
                                                    <td rowspan="4" class ="br-2 br-1-0">실판매</td>
                                                    <td class ="br-2">목표량</td>
                                                        ${data_row_10}
                                                  </tr>
                                                  <tr>
                                                    <td class ="br-2">판매량</td>
                                                        ${data_row_11}
                                                  </tr>
                                                  <tr>
                                                    <td class ="br-2">목표%</td>
                                                        ${data_row_12}
                                                  </tr>
                                                  <tr>
                                                    <td class ="br-2">전년%</td>
                                                        ${data_row_13}
                                                  </tr>
                                                  <tr>
                                                    <td rowspan="2" class ="br-2 br-1-0">총재고<br>(정품<br>수량)</td>
                                                    <td class ="br-2">재고량</td>
                                                        ${data_row_14}
                                                  </tr>
                                                  <tr>
                                                    <td class ="br-2">전년%</td>
                                                        ${data_row_15}
                                                  </tr>
                                                  <tr>
                                                    <td rowspan="2" class ="br-2 br-1-0">정품재고<br>금액</td>
                                                    <td class ="br-2">재고금액</td>
                                                        ${data_row_16}
                                                  </tr>
                                                  <tr>
                                                    <td class ="br-2">전년%</td>
                                                        ${data_row_17}
                                                  </tr>
                                                  <tr>
                                                    <td rowspan="2" class ="br-2 br-1-0">이등품<br>재고금액</td>
                                                    <td class ="br-2">재고금액</td>
                                                        ${data_row_18}
                                                  </tr>
                                                  <tr>
                                                    <td class ="br-2 br-1-0">전년%</td>
                                                        ${data_row_19}
                                                  </tr>

                                            </tbody>
                                            <!--end::Table body-->
                                           </table>
                                           <!--end::Table-->
                                          </div>
                                          <!--end::Table container-->
                                         </div>
                                    </div>
                                    </div>
                                    </div>
                                    </div>
                                    </div>
                                    </div>
                                `
                            $("body").empty()
                            $("body").append(html)
                        }
    function dashboardDetailEcynEc(data, name){
                            let month = ""
                            let data_row_1 = ""
                            let data_row_2 = ""
                            let data_row_3 = ""
                            let data_row_4 = ""
                            let data_row_5 = ""
                            let data_row_6 = ""
                            let data_row_7 = ""
                            let data_row_8 = ""
                            let data_row_9 = ""
                            let data_row_10 = ""
                            let data_row_11 = ""
                            let data_row_12 = ""
                            let data_row_13 = ""

                            if(data.proc == "success") {
                                for(let i=0; i<data.month.length; i++) {
                                    let monthValue = data.month[i];
                                    month += `<th class="min-w-75px" style="text-align: center !important;">${monthValue}</th>`;
                                }
                                var targetString = '1~12월 계';
                                var indexOfTarget = data.month.indexOf(targetString);

                                for (let i = 1; i < data.list.length; i++) {
                                    let value = data.list[i];
                                    let updateValue = value.splice(value.length - 2, 1);
                                    value.splice(indexOfTarget + 1, 0, updateValue[0]);
                                    for(let j=1; j< value.length; j++) {
                                        if(i == 1) {
                                            if(j == indexOfTarget + 1) {
                                                data_row_1 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else if(j == parseInt(value.length) - 1) {
                                                data_row_1 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else {
                                                data_row_1 += `<td>${numberWithCommas(value[j])}</td>`
                                            }
                                        }else if(i == 2) {
                                            if(j == indexOfTarget + 1) {
                                                data_row_2 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else if(j == parseInt(value.length) - 1) {
                                                data_row_2 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else {
                                                data_row_2 += `<td>${numberWithCommas(value[j])}</td>`
                                            }
                                        }else if(i == 3) {
                                            if(j == indexOfTarget + 1) {
                                                data_row_3 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else if(j == parseInt(value.length) - 1) {
                                                data_row_3 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else {
                                                data_row_3 += `<td>${numberWithCommas(value[j])}</td>`
                                            }
                                        }else if(i == 4) {
                                            if(j == indexOfTarget + 1) {
                                                data_row_4 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else if(j == parseInt(value.length) - 1) {
                                                data_row_4 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else {
                                                data_row_4 += `<td>${numberWithCommas(value[j])}</td>`
                                            }
                                        }else if(i == 5) {
                                            if(j == indexOfTarget + 1) {
                                                data_row_5 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else if(j == parseInt(value.length) - 1) {
                                                data_row_5 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else {
                                                data_row_5 += `<td>${numberWithCommas(value[j])}</td>`
                                            }
                                        }else if(i == 6) {
                                            if(j == indexOfTarget + 1) {
                                                data_row_6 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else if(j == parseInt(value.length) - 1) {
                                                data_row_6 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else {
                                                data_row_6 += `<td>${numberWithCommas(value[j])}</td>`
                                            }
                                        }else if(i == 7) {
                                            if(j == indexOfTarget + 1) {
                                                data_row_7 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else if(j == parseInt(value.length) - 1) {
                                                data_row_7 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else {
                                                data_row_7 += `<td>${numberWithCommas(value[j])}</td>`
                                            }
                                        }else if(i == 8) {
                                            if(j == indexOfTarget + 1) {
                                                data_row_8 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else if(j == parseInt(value.length) - 1) {
                                                data_row_8 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else {
                                                data_row_8 += `<td>${numberWithCommas(value[j])}</td>`
                                            }
                                        }else if(i == 9) {
                                            if(j == indexOfTarget + 1) {
                                                data_row_9 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else if(j == parseInt(value.length) - 1) {
                                                data_row_9 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else {
                                                data_row_9 += `<td>${numberWithCommas(value[j])}</td>`
                                            }
                                        }else if(i == 10) {
                                            if(j == indexOfTarget + 1) {
                                                data_row_10 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else if(j == parseInt(value.length) - 1) {
                                                data_row_10 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else {
                                                data_row_10 += `<td>${numberWithCommas(value[j])}</td>`
                                            }
                                        }else if(i == 11) {
                                            if(j == indexOfTarget + 1) {
                                                data_row_11 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else if(j == parseInt(value.length) - 1) {
                                                data_row_11 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else {
                                                data_row_11 += `<td>${numberWithCommas(value[j])}</td>`
                                            }
                                        }else if(i == 12) {
                                            if(j == indexOfTarget + 1) {
                                                data_row_12 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else if(j == parseInt(value.length) - 1) {
                                                data_row_12 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else {
                                                data_row_12 += `<td>${numberWithCommas(value[j])}</td>`
                                            }
                                        }else if(i == 13) {
                                            if(j == indexOfTarget + 1) {
                                                data_row_13 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else if(j == parseInt(value.length) - 1) {
                                                data_row_13 += `<td class='current-m1'>${numberWithCommas(value[j])}</td>`
                                            }else {
                                                data_row_13 += `<td>${numberWithCommas(value[j])}</td>`
                                            }
                                        }
                                    }
                                }
                            }
                            let year = "{{year}}"
                            let html = `
                              <div class="d-flex flex-column flex-root">
                                   <!--begin::Page-->
                                   <div class="page d-flex flex-row flex-column-fluid">
                                    <div class="d-flex flex-column flex-row-fluid" id="kt_wrapper">
                                     <div class="content d-flex flex-column flex-column-fluid" id="kt_content">
                                      <!--end::Toolbar-->
                                      <div class="post d-flex flex-column-fluid" id="kt_post">
                                       <div id="kt_content_container" class="container-xxl">
                                <span class="nav-link btn-color-muted btn-active btn-active-light-primary active fw-bolder" style="cursor:pointer" onclick="location.href='/venus/web-tab/?source=kusrc_heroku_prod'" >돌아가기</span>
                                     <div class="card mb-5 mb-xl-8">
                                     <!--begin::Header-->
                                     <div class="card-header border-0 pt-5">
                                      <h3 class="card-title align-items-start flex-column">
                                       <span class="card-label fw-bolder fs-3 mb-1">실매출 추이에 따른 생산량 조절 [ ${name} ]</span>
                                       <span class="text-muted mt-1 fw-bold fs-7"></span>
                                      </h3>
                                      <div class="card-toolbar">

                                       <!--begin::Menu 2-->
                                       <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fw-bold w-200px" data-kt-menu="true">
                                        <!--begin::Menu item-->
                                        <div class="menu-item px-3">
                                         <div class="menu-content fs-6 text-dark fw-bolder px-3 py-4">Dashboard</div>
                                        </div>
                                        <!--end::Menu item-->
                                        <!--begin::Menu separator-->
                                        <div class="separator mb-3 opacity-75"></div>
                                        <!--end::Menu separator-->
                                        <!--begin::Menu item-->
                                        <div class="menu-item px-3">
                                         <a href="#" class="menu-link px-3" onclick="test()">차트로 내용 보기</a>
                                        </div>
                                        <div class="separator mb-3 opacity-75"></div>
                                       </div>
                                       <!--end::Menu 2-->
                                       <!--end::Menu-->
                                      </div>
                                     </div>
                                     <!--end::Header-->
                                     <!--begin::Body-->
                                     <div class="card-body py-3" class="table_view_static">
                                      <!--begin::Table container-->
                                      <div class="table-responsive">
                                       <!--begin::Table-->
                                       <table class="table align-middle gs-0 gy-4" id="">
                                        <!--begin::Table head-->
                                        <thead>
                                         <tr class="fw-bolder text-muted bg-light">
                                          <th class="ps-4 min-w-200px rounded-start" colspan="3">구분</th>
                                                    ${month}
                                         </tr>
                                        </thead>
                                        <!--end::Table head-->
                                        <!--begin::Table body-->
                                        <tbody>
                                            <tr>
                                                <td rowspan="5" class ="br-2"  style="border-bottom:1px solid #A1A5B7 !important;">${year-1}년</td>
                                                <td colspan="2" class ="br-2">생산량</td>
                                                    ${data_row_1}
                                              </tr>
                                              <tr>
                                                <td colspan="2" class ="br-2">판매량</td>
                                                    ${data_row_2}
                                              </tr>
                                              <tr>
                                                <td colspan="2" class ="br-2">%</td>
                                                    ${data_row_3}
                                              </tr>
                                              <tr>
                                                <td colspan="2" class ="br-2">재고수량</td>
                                                    ${data_row_4}
                                              </tr>
                                              <tr>
                                                <td colspan="2" class ="br-2" style="border-bottom:1px solid #A1A5B7 !important;">재고금액</td>
                                                    ${data_row_5}
                                              </tr>
                                              <tr>
                                                <td rowspan="8" class="br-2 br-1-0">${year}년</td>
                                                <td rowspan="2" class ="br-2 br-1-0">생산</td>
                                                <td class ="br-2">생산량</td>
                                                    ${data_row_6}
                                              </tr>
                                              <tr>
                                                <td class ="br-2">전년%</td>
                                                    ${data_row_7}
                                              </tr>
                                              <tr>
                                                <td rowspan="2" class ="br-2 br-1-0">판매량</td>
                                                <td class ="br-2">판매량</td>
                                                    ${data_row_8}
                                              </tr>
                                              <tr>
                                                <td class ="br-2">전년%</td>
                                                    ${data_row_9}
                                              </tr>
                                              <tr>
                                                <td rowspan="2" class ="br-2 br-1-0">재고수량</td>
                                                <td class ="br-2">재고량</td>
                                                    ${data_row_10}
                                              </tr>
                                              <tr>
                                                <td class ="br-2">전년%</td>
                                                    ${data_row_11}
                                              </tr>
                                              <tr>
                                                <td rowspan="2" class ="br-2 br-1-0">재고금액</td>
                                                <td class ="br-2">재고금액</td>
                                                    ${data_row_12}
                                              </tr>
                                              <tr>
                                                <td class ="br-2">전년%</td>
                                                    ${data_row_13}
                                              </tr>
                                        </tbody>
                                        <!--end::Table body-->
                                       </table>
                                       <!--end::Table-->
                                      </div>
                                      <!--end::Table container-->
                                     </div>
                                </div>
                                </div>
                                </div>
                                </div>
                                </div>
                                </div>
                            `
                        $("body").empty()
                        $("body").append(html)
                    }


function calculateRatio(a, b) {
    if (b === 0) {
        return "";
    }
    let result = (a / b) * 100;
    result = Math.round(result * 10) / 10;
    return result
}

let infoBox;

document.addEventListener('mouseover', function (event) {
    const target = event.target;

    if (target.classList.contains('div_info')) {
        const info = target.getAttribute('data-info')
        const stdt = target.getAttribute('data-stdt')
        const endt = target.getAttribute('data-endt')
        infoBox = document.createElement('div');
        infoBox.id = 'infoBox';
        infoBox.className = 'infoBox';
        infoBox.style.position = 'absolute';
        infoBox.style.backgroundColor = '#fff';
        infoBox.style.border = '1px solid #ccc';
        infoBox.style.padding = '10px';
        infoBox.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.1)';
        infoBox.style.zIndex = "244444444"

        const rect = target.getBoundingClientRect();
        infoBox.style.top = (rect.bottom + window.scrollY) + 'px';
        infoBox.style.left = rect.left + 'px';

        infoBox.innerHTML = info + "<br>" + stdt + " ~ " + endt;
        document.body.appendChild(infoBox);

        infoBox.addEventListener('click', function () {
            if (target) {
                target.click();
            }
        });
    }
});


document.addEventListener('mouseout', function (event) {
    const target = event.target;

    if (!target.classList.contains('div_info') && !infoBox.contains(target)) {
        const parentTD = target.closest('td');

        if (infoBox) {
            infoBox.remove();
        }
        $("#infoBox").remove();
    }
});


function calendar_color_func(code, _index) {

    let color = ""
    switch (_index) {

        case 0:
            if(code == "V") {
                color = "#FD7E14"
            }else if(code == "W") {
                color = "#8ec390"
            }else {
                color = "#4C6EF5"
            }
            break;
        case 1:
            if(code == "V") {
                color = "#FF922B"
            }else if(code == "W") {
                color = "#93c89f"
            }else {
                color = "#5C7CFA"
            }
            break;
        case 2:
            if(code == "V") {
                color = "#FFA94D"
            }else if(code == "W") {
                color = "#99cfab"
            }else {
                color = "#748FFC"
            }
            break;
        case 3:
            if(code == "V") {
                color = "#FFC078"
            }else if(code == "W") {
                color = "#9fd6b7"
            }else {
                color = "#91A7FF"
            }
            break;
        case 4:
            if(code == "V") {
                color = "#FFD8A8"
            }else if(code == "W") {
                color = "#a5ddc4"
            }else {
                color = "#BAC8FF"
            }
            break;
        case 5:
            if(code == "V") {
                color = "#FFE8CC"
            }else if(code == "W") {
                color = "#abf4d0"
            }else {
                color = "#DBE4FF"
            }
            break;
        case 6:
            if(code == "V") {
                color = "#FFF4E6"
            }else if(code == "W") {
                color = "#b1fbdc"
            }else {
                color = "#EDF2FF"
            }
            break;
    }

    return color
}
</script>

</html>